{"version":3,"file":"access-groups.js","names":["_rdflib","require","_acl","widgets","_interopRequireWildcard","ns","_addAgentButtons","debug","style","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","prototype","hasOwnProperty","call","i","set","ACL","acl","COLLOQUIAL","RECOMMENDED","EXPLANATION","AccessGroups","exports","doc","aclDoc","controller","store","options","arguments","length","undefined","_classCallCheck2","_defineProperty2","defaults","_store","aclMap","readACL","byCombo","ACLbyCombination","addAgentButton","AddAgentButtons","rootElement","dom","createElement","setAttribute","accessGroupList","_createClass2","key","value","render","_this","innerHTML","renderGroups","forEach","group","appendChild","isEditable","groupElements","comboIndex","combo","kToCombo","push","renderGroup","_this2","groupRow","accessGroupListItem","makeDropTarget","uris","handleDroppedUris","then","error","renderStatus","groupColumns","renderGroupElements","column","_this3","groupNameColumn","group1","group2","group3","group5","group9","group13","innerText","ktToList","groupAgentsColumn","groupAgentsTable","combos","map","_ref","_ref2","_slicedToArray2","pred","obj","renderAgent","agentElement","groupDescriptionElement","_this4","personRow","personTR","sym","deleteFunction","deleteAgent","removeChild","_deleteAgent","_asyncToGenerator2","_regenerator","mark","_callee","comboToRemove","wrap","_callee$","_context","prev","next","find","_ref3","_ref4","comboPred","comboObj","splice","indexOf","save","stop","_x","_x2","_x3","apply","_addNewURI","_callee2","uri","_callee2$","_context2","handleDroppedUri","addNewURI","_x4","_handleDroppedUris","_callee3","_this5","_callee3$","_context3","Promise","all","t0","abrupt","reject","_x5","_x6","_handleDroppedUri","_this6","secondAttempt","_callee4","agent","thing","_this6$_store","_this6$_store$fetcher","message","_callee4$","_context4","findAgent","log","concat","fetcher","load","Error","setACLCombo","subject","_x7","_x8","res","removeAgentFromCombos","k","y","sort","join","list","kb","types","findTypeURIs","ty","startsWith","split","endsWith","slice","vcard","sameTerm","foaf","rdf","owl","pref","any","solid"],"sources":["../../src/acl/access-groups.ts"],"sourcesContent":["/**\n * Contains the [[AccessGroups]]\n * and [[AccessGroupsOptions]] classes\n * @packageDocumentation\n */\n\nimport { NamedNode, sym, Store } from 'rdflib'\nimport { ACLbyCombination, readACL } from './acl'\nimport * as widgets from '../widgets'\nimport * as ns from '../ns'\nimport { AccessController } from './access-controller'\nimport { AgentMapMap, ComboList, PartialAgentTriple } from './types'\nimport { AddAgentButtons } from './add-agent-buttons'\nimport * as debug from '../debug'\nimport * as style from '../style'\n\nconst ACL = ns.acl\n\nconst COLLOQUIAL = {\n  13: 'Owners',\n  9: 'Owners (write locked)',\n  5: 'Editors',\n  3: 'Posters',\n  2: 'Submitters',\n  1: 'Viewers'\n}\n\nconst RECOMMENDED = {\n  13: true,\n  5: true,\n  3: true,\n  2: true,\n  1: true\n}\n\nconst EXPLANATION = {\n  13: 'can read, write, and control sharing.',\n  9: 'can read and control sharing, currently write-locked.',\n  5: 'can read and change information',\n  3: 'can add new information, and read but not change existing information',\n  2: 'can add new information but not read any',\n  1: 'can read but not change information'\n}\n\n/**\n * Type for the options parameter of [[AccessGroups]]\n */\nexport interface AccessGroupsOptions {\n  defaults?: boolean\n}\n\n/**\n * Renders the table of Owners, Editors, Posters, Submitters, Viewers\n * for https://github.com/solidos/userguide/blob/main/views/sharing/userguide.md\n */\nexport class AccessGroups {\n  private readonly defaults: boolean\n  public byCombo: ComboList\n  public aclMap: AgentMapMap\n  private readonly addAgentButton: AddAgentButtons\n  private readonly rootElement: HTMLElement\n  private _store: Store // @@ was LiveStore but does not need to be connected to web\n\n  constructor (\n    private doc: NamedNode,\n    private aclDoc: NamedNode,\n    public controller: AccessController,\n    store: Store, // @@ was LiveStore\n    private options: AccessGroupsOptions = {}\n  ) {\n    this.defaults = options.defaults || false\n    this._store = store\n    this.aclMap = readACL(doc, aclDoc, store, this.defaults)\n    this.byCombo = ACLbyCombination(this.aclMap)\n    this.addAgentButton = new AddAgentButtons(this)\n    this.rootElement = this.controller.dom.createElement('div')\n    this.rootElement.setAttribute('style', style.accessGroupList)\n  }\n\n  public get store () {\n    return this._store\n  }\n\n  public set store (store) {\n    this._store = store\n    this.aclMap = readACL(this.doc, this.aclDoc, store, this.defaults)\n    this.byCombo = ACLbyCombination(this.aclMap)\n  }\n\n  public render (): HTMLElement {\n    this.rootElement.innerHTML = ''\n    this.renderGroups().forEach(group => this.rootElement.appendChild(group))\n    if (this.controller.isEditable) {\n      this.rootElement.appendChild(this.addAgentButton.render())\n    }\n    return this.rootElement\n  }\n\n  private renderGroups (): HTMLElement[] {\n    const groupElements: HTMLElement[] = []\n    for (let comboIndex = 15; comboIndex > 0; comboIndex--) {\n      const combo = kToCombo(comboIndex)\n      if ((this.controller.isEditable && RECOMMENDED[comboIndex]) || this.byCombo[combo]) {\n        groupElements.push(this.renderGroup(comboIndex, combo))\n      }\n    }\n    return groupElements\n  }\n\n  private renderGroup (comboIndex: number, combo: string): HTMLElement {\n    const groupRow = this.controller.dom.createElement('div')\n    groupRow.setAttribute('style', style.accessGroupListItem)\n    widgets.makeDropTarget(groupRow, (uris) => this.handleDroppedUris(uris, combo)\n      .then(() => this.controller.render())\n      .catch(error => this.controller.renderStatus(error)))\n    const groupColumns = this.renderGroupElements(comboIndex, combo)\n    groupColumns.forEach(column => groupRow.appendChild(column))\n    return groupRow\n  }\n\n  private renderGroupElements (comboIndex, combo): HTMLElement[] {\n    const groupNameColumn = this.controller.dom.createElement('div')\n    groupNameColumn.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupNameColumn.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupNameColumn.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupNameColumn.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupNameColumn.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupNameColumn.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupNameColumn.setAttribute('style', style.group13)\n          break\n        default:\n          groupNameColumn.setAttribute('style', style.group)\n      }\n    }\n    groupNameColumn.innerText = COLLOQUIAL[comboIndex] || ktToList(comboIndex)\n\n    const groupAgentsColumn = this.controller.dom.createElement('div')\n    groupAgentsColumn.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupAgentsColumn.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupAgentsColumn.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupAgentsColumn.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupAgentsColumn.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupAgentsColumn.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupAgentsColumn.setAttribute('style', style.group13)\n          break\n        default:\n          groupAgentsColumn.setAttribute('style', style.group)\n      }\n    }\n    const groupAgentsTable = groupAgentsColumn.appendChild(this.controller.dom.createElement('table'))\n    const combos = this.byCombo[combo] || []\n    combos\n      .map(([pred, obj]) => this.renderAgent(groupAgentsTable, combo, pred, obj))\n      .forEach(agentElement => groupAgentsTable.appendChild(agentElement))\n\n    const groupDescriptionElement = this.controller.dom.createElement('div')\n    groupDescriptionElement.setAttribute('style', style.group)\n    if (this.controller.isEditable) {\n      switch (comboIndex) {\n        case 1:\n          groupDescriptionElement.setAttribute('style', style.group1)\n          break\n        case 2:\n          groupDescriptionElement.setAttribute('style', style.group2)\n          break\n        case 3:\n          groupDescriptionElement.setAttribute('style', style.group3)\n          break\n        case 5:\n          groupDescriptionElement.setAttribute('style', style.group5)\n          break\n        case 9:\n          groupDescriptionElement.setAttribute('style', style.group9)\n          break\n        case 13:\n          groupDescriptionElement.setAttribute('style', style.group13)\n          break\n        default:\n          groupDescriptionElement.setAttribute('style', style.group)\n      }\n    }\n    groupDescriptionElement.innerText = EXPLANATION[comboIndex] || 'Unusual combination'\n\n    return [groupNameColumn, groupAgentsColumn, groupDescriptionElement]\n  }\n\n  private renderAgent (groupAgentsTable, combo, pred, obj): HTMLElement {\n    const personRow = widgets.personTR(this.controller.dom, ACL(pred), sym(obj), this.controller.isEditable\n      ? {\n          deleteFunction: () => this.deleteAgent(combo, pred, obj)\n            .then(() => groupAgentsTable.removeChild(personRow))\n            .catch(error => this.controller.renderStatus(error))\n        }\n      : {})\n    return personRow\n  }\n\n  private async deleteAgent (combo, pred, obj): Promise<void> {\n    const combos = this.byCombo[combo] || []\n    const comboToRemove = combos.find(([comboPred, comboObj]) => comboPred === pred && comboObj === obj)\n    if (comboToRemove) {\n      combos.splice(combos.indexOf(comboToRemove), 1)\n    }\n    await this.controller.save()\n  }\n\n  public async addNewURI (uri: string): Promise<void> {\n    await this.handleDroppedUri(uri, kToCombo(1))\n    await this.controller.save()\n  }\n\n  private async handleDroppedUris (uris: string[], combo: string): Promise<void> {\n    try {\n      await Promise.all(uris.map(uri => this.handleDroppedUri(uri, combo)))\n      await this.controller.save()\n    } catch (error) {\n      return Promise.reject(error)\n    }\n  }\n\n  private async handleDroppedUri (uri: string, combo: string, secondAttempt: boolean = false): Promise<void> {\n    const agent = findAgent(uri, this.store) // eg 'agent', 'origin', agentClass'\n    const thing = sym(uri)\n    if (!agent && !secondAttempt) {\n      debug.log(`   Not obvious: looking up dropped thing ${thing}`)\n      try {\n        await this._store?.fetcher?.load(thing.doc())\n      } catch (error) {\n        const message = `Ignore error looking up dropped thing: ${error}`\n        debug.error(message)\n        return Promise.reject(new Error(message))\n      }\n      return this.handleDroppedUri(uri, combo, true)\n    } else if (!agent) {\n      const error = `   Error: Drop fails to drop appropriate thing! ${uri}`\n      debug.error(error)\n      return Promise.reject(new Error(error))\n    }\n    this.setACLCombo(combo, uri, agent, this.controller.subject)\n  }\n\n  private setACLCombo (combo: string, uri: string, res: PartialAgentTriple, subject: NamedNode): void {\n    if (!(combo in this.byCombo)) {\n      this.byCombo[combo] = []\n    }\n    this.removeAgentFromCombos(uri) // Combos are mutually distinct\n    this.byCombo[combo].push([res.pred, res.obj.uri])\n    debug.log(`ACL: setting access to ${subject} by ${res.pred}: ${res.obj}`)\n  }\n\n  private removeAgentFromCombos (uri: string): void {\n    for (let k = 0; k < 16; k++) {\n      const combos = this.byCombo[kToCombo(k)]\n      if (combos) {\n        for (let i = 0; i < combos.length; i++) {\n          while (i < combos.length && combos[i][1] === uri) {\n            combos.splice(i, 1)\n          }\n        }\n      }\n    }\n  }\n}\n\nfunction kToCombo (k: number): string {\n  const y = ['Read', 'Append', 'Write', 'Control']\n  const combo: string[] = []\n  for (let i = 0; i < 4; i++) {\n    if (k & (1 << i)) {\n      combo.push('http://www.w3.org/ns/auth/acl#' + y[i])\n    }\n  }\n  combo.sort()\n  return combo.join('\\n')\n}\n\nfunction ktToList (k: number): string {\n  let list = ''\n  const y = ['Read', 'Append', 'Write', 'Control']\n  for (let i = 0; i < 4; i++) {\n    if (k & (1 << i)) {\n      list += y[i]\n    }\n  }\n  return list\n}\n\nfunction findAgent (uri, kb): PartialAgentTriple | null {\n  const obj = sym(uri)\n  const types = kb.findTypeURIs(obj)\n  for (const ty in types) {\n    debug.log('    drop object type includes: ' + ty)\n  }\n  // An Origin URI is one like https://fred.github.io eith no trailing slash\n  if (uri.startsWith('http') && uri.split('/').length === 3) {\n    // there is no third slash\n    return { pred: 'origin', obj } // The only way to know an origin alas\n  }\n  // @@ This is an almighty kludge needed because drag and drop adds extra slashes to origins\n  if (\n    uri.startsWith('http') &&\n    uri.split('/').length === 4 &&\n    uri.endsWith('/')\n  ) {\n    // there  IS third slash\n    debug.log('Assuming final slash on dragged origin URI was unintended!')\n    return { pred: 'origin', obj: sym(uri.slice(0, -1)) } // Fix a URI where the drag and drop system has added a spurious slash\n  }\n\n  if (ns.vcard('WebID').uri in types) return { pred: 'agent', obj }\n\n  if (ns.vcard('Group').uri in types) {\n    return { pred: 'agentGroup', obj } // @@ note vcard membership not RDFs\n  }\n  if (\n    obj.sameTerm(ns.foaf('Agent')) ||\n    obj.sameTerm(ns.acl('AuthenticatedAgent')) || // AuthenticatedAgent\n    obj.sameTerm(ns.rdf('Resource')) ||\n    obj.sameTerm(ns.owl('Thing'))\n  ) {\n    return { pred: 'agentClass', obj }\n  }\n  if (\n    ns.vcard('Individual').uri in types ||\n    ns.foaf('Person').uri in types ||\n    ns.foaf('Agent').uri in types\n  ) {\n    const pref = kb.any(obj, ns.foaf('preferredURI'))\n    if (pref) return { pred: 'agent', obj: sym(pref) }\n    return { pred: 'agent', obj }\n  }\n  if (ns.solid('AppProvider').uri in types) {\n    return { pred: 'origin', obj }\n  }\n  if (ns.solid('AppProviderClass').uri in types) {\n    return { pred: 'originClass', obj }\n  }\n  debug.log('    Triage fails for ' + uri)\n  return null\n}\n"],"mappings":"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"}