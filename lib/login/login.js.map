{"version":3,"file":"login.js","names":["_rdflib","require","_solidLogic","debug","_interopRequireWildcard","style","_log","ns","_signup","utils","widgets","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_createForOfIteratorHelper","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","_n","F","s","done","value","f","TypeError","o","next","_arrayLikeToArray","toString","slice","constructor","name","from","test","store","solidLogicSingleton","_solidLogicSingleton$","profile","loadPreferences","loadProfile","_solidLogicSingleton$2","typeIndex","getScopedAppInstances","getRegistrations","loadAllTypeIndexes","getScopedAppsFromIndex","deleteTypeIndexRegistration","ensureLoggedIn","context","me","authn","currentUser","saveUser","Promise","resolve","checkUser","then","webId","log","concat","div","dom","box","loginStatusBox","webIdUri","appendChild","ensureLoadedPreferences","_x","_ensureLoadedPreferences","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee4","progressDisplay","preferencesFile","m2","wrap","_callee4$","_context4","prev","abrupt","ensureLoadedProfile","sent","parentNode","removeChild","t0","UnauthorizedError","alert","CrossOriginForbiddenError","window","location","origin","preferencesFileError","SameOriginForbiddenError","warn","NotEditableError","WebOperationError","FetchError","status","message","Error","stop","_x2","_ensureLoadedProfile","_callee5","logInContext","_callee5$","_context5","publicProfile","errorMessageBlock","findAppInstances","_x3","_x4","_x5","_findAppInstances","_callee6","theClass","isPublic","items","_callee6$","_context6","filter","item","scope","label","instances","map","instance","scopeLabel","mine","sameTerm","agent","registrationControl","_x6","_x7","_x8","_registrationControl","_callee7","registrationStatements","renderScopeCheckbox","scopes","msg","tbody","form","_iterator","_step","row","_callee7$","_context7","_renderScopeCheckbox","statements","index","noun","buildCheckboxForm","_registrationStatemen","registrations","reg","newThing","st","solid","createElement","innerHTML","textContent","setAttribute","children","BlankNode","err","renderScopeHeadingRow","backgroundColor","cell","backgoundColor","header","textAlign","registrationList","_x9","_x10","_registrationList","_callee9","options","table","_iterator2","_step2","headingRow","_iterator3","_step3","_loop","_callee9$","_context10","firstChild","type","display","_loop$","_context9","personTR","deleteFunction","_deleteFunction","_callee8","_callee8$","_context8","paddingLeft","delegateYield","t1","finish","t2","signInOrSignUpBox","setUserCallback","undefined","signInButtonStyle","buttonStyle","signInAndUpButtonStyle","magicClassName","signInPopUpButton","headerBannerLoginInput","signUpBackground","authSession","onLogin","webIdURI","uri","divs","getElementsByClassName","parent","addEventListener","offline","offlineTestID","renderSignInPopup","signupButton","signInBackground","_event","signupMgr","Signup","signup","issuerPopup","body","issuerPopupBox","issuerPopupBoxTopMenu","issuerPopupBoxLabel","innerText","issuerPopupBoxCloseButton","remove","loginToIssuer","_ref","_callee","issuerUri","preLoginRedirectHash","locationUrl","_callee$","_context","updater","flagAuthorizationMetadata","URL","href","hash","localStorage","setItem","login","redirectUrl","oidcIssuer","_x11","issuerTextContainer","issuerTextInputContainer","issuerTextLabel","issuerTextInput","getItem","issuerTextGoButton","issuerButtonContainer","issuerBottonLabel","getSuggestedIssuers","forEach","issuerInfo","issuerButton","listener","setIt","newidURI","refresh","logoutButtonHandler","oldMe","logout","logoutButton","logoutLabel","nick","any","foaf","signOutButton","sessionInfo","info","isLoggedIn","sym","clearElement","trackSession","onLogout","_callee2","issuer","wellKnownUri","wellKnownResult","openidConfiguration","_callee2$","_context2","pathname","fetch","json","end_session_endpoint","credentials","reload","selectWorkspace","appDetails","callbackWS","appPathSegment","say","background","figureOutBase","ws","newBaseNode","space","newBaseString","split","now","Date","getTime","displayOptions","makeNewWorkspace","_x12","_makeNewWorkspace","_callee3","newBase","newWs","newData","_callee3$","_context3","padding","encodeURI","askName","update","id","w","each","storages","ldp","file","includes","toLowerCase","p","commentStyle","baseField","textInputStyle","size","autocomplete","button","replace","x","holds","rdf","col1","col2","col3","tr","localStyle","comment","cellStyle","deselectedStyle","anyValue","ui","reduce","b","charCodeAt","bgcolor","target","rdfs","disabled","trLast","newAppInstance","callback","gotWS","base","getUserRoles","_getUserRoles","_callee10","_yield$ensureLoadedPr","_callee10$","_context11","doc","filterAvailablePanes","_x13","_filterAvailablePanes","_callee11","panes","userRoles","_callee11$","_context12","pane","isMatchingAudience","audience","isMatch","audienceRole","find","role","equals"],"sources":["../../src/login/login.ts"],"sourcesContent":["/* eslint-disable camelcase */\n/**\n * Signing in, signing up, profile and preferences reloading\n * Type index management\n *\n * Many functions in this module take a context object which\n * holds various RDF symbols, add to it, and return a promise of it.\n *\n * * `me`                RDF symbol for the user's WebID\n * * `publicProfile`     The user's public profile, iff loaded\n * * `preferencesFile`   The user's personal preference file, iff loaded\n * * `index.public`      The user's public type index file\n * * `index.private`     The user's private type index file\n *\n * Not RDF symbols:\n * * `noun`            A string in english for the type of thing -- like \"address book\"\n * * `instance`        An array of nodes which are existing instances\n * * `containers`      An array of nodes of containers of instances\n * * `div`             A DOM element where UI can be displayed\n * * `statusArea`      A DOM element (opt) progress stuff can be displayed, or error messages\n * *\n * * Vocabulary:  \"load\" loads a file if it exists;\n * *  'Ensure\" CREATES the file if it does not exist (if it can) and then loads it.\n * @packageDocumentation\n */\nimport { PaneDefinition } from 'pane-registry'\nimport { BlankNode, NamedNode, st } from 'rdflib'\n// eslint-disable-next-line camelcase\nimport { Quad_Object } from 'rdflib/lib/tf-types'\nimport {\n  AppDetails,\n  AuthenticationContext,\n  authn,\n  authSession,\n  CrossOriginForbiddenError,\n  FetchError,\n  getSuggestedIssuers,\n  NotEditableError,\n  offlineTestID,\n  SameOriginForbiddenError,\n  solidLogicSingleton,\n  UnauthorizedError,\n  WebOperationError\n} from 'solid-logic'\nimport * as debug from '../debug'\nimport * as style from '../style'\nimport { alert } from '../log'\nimport * as ns from '../ns.js'\nimport { Signup } from '../signup/signup.js'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\n\nconst store = solidLogicSingleton.store\n\nconst {\n  loadPreferences,\n  loadProfile\n} = solidLogicSingleton.profile\n\nconst {\n  getScopedAppInstances,\n  getRegistrations,\n  loadAllTypeIndexes,\n  getScopedAppsFromIndex,\n  deleteTypeIndexRegistration\n} = solidLogicSingleton.typeIndex\n\n/**\n * Resolves with the logged in user's WebID\n *\n * @param context\n */\n// used to be logIn\nexport function ensureLoggedIn (context: AuthenticationContext): Promise<AuthenticationContext> {\n  const me = authn.currentUser()\n  if (me) {\n    authn.saveUser(me, context)\n    return Promise.resolve(context)\n  }\n\n  return new Promise((resolve) => {\n    authn.checkUser().then((webId) => {\n      // Already logged in?\n      if (webId) {\n        debug.log(`logIn: Already logged in as ${webId}`)\n        return resolve(context)\n      }\n      if (!context.div || !context.dom) {\n        return resolve(context)\n      }\n      const box = loginStatusBox(context.dom, (webIdUri) => {\n        authn.saveUser(webIdUri, context)\n        resolve(context) // always pass growing context\n      })\n      context.div.appendChild(box)\n    })\n  })\n}\n\n/**\n * Loads preference file\n * Do this after having done log in and load profile\n *\n * @private\n *\n * @param context\n */\n// used to be logInLoadPreferences\nexport async function ensureLoadedPreferences (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.preferencesFile) return Promise.resolve(context) // already done\n\n  // const statusArea = context.statusArea || context.div || null\n  let progressDisplay\n  /* COMPLAIN FUNCTION NOT USED/TAKING IT OUT FOR NOW\n    function complain (message) {\n    message = `ensureLoadedPreferences: ${message}`\n    if (statusArea) {\n      // statusArea.innerHTML = ''\n      statusArea.appendChild(widgets.errorMessageBlock(context.dom, message))\n    }\n    debug.log(message)\n    // reject(new Error(message))\n  } */\n  try {\n    context = await ensureLoadedProfile(context)\n\n    // console.log('back in Solid UI after logInLoadProfile', context)\n    const preferencesFile = await loadPreferences(context.me as NamedNode)\n    if (progressDisplay) {\n      progressDisplay.parentNode.removeChild(progressDisplay)\n    }\n    context.preferencesFile = preferencesFile\n  } catch (err) {\n    let m2: string\n    if (err instanceof UnauthorizedError) {\n      m2 =\n        'Ooops - you are not authenticated (properly logged in) to for me to read your preference file.  Try loggin out and logging in?'\n      alert(m2)\n    } else if (err instanceof CrossOriginForbiddenError) {\n      m2 = `Unauthorized: Assuming preference file blocked for origin ${window.location.origin}`\n      context.preferencesFileError = m2\n      return context\n    } else if (err instanceof SameOriginForbiddenError) {\n      m2 =\n        'You are not authorized to read your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof NotEditableError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof WebOperationError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n    } else if (err instanceof FetchError) {\n      m2 = `Strange: Error ${err.status} trying to read your preference file.${err.message}`\n      alert(m2)\n    } else {\n      throw new Error(`(via loadPrefs) ${err}`)\n    }\n  }\n  return context\n}\n\n/**\n * Logs the user in and loads their WebID profile document into the store\n *\n * @param context\n *\n * @returns Resolves with the context after login / fetch\n */\n// used to be logInLoadProfile\nexport async function ensureLoadedProfile (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.publicProfile) {\n    return context\n  } // already done\n  try {\n    const logInContext = await ensureLoggedIn(context)\n    if (!logInContext.me) {\n      throw new Error('Could not log in')\n    }\n    context.publicProfile = await loadProfile(logInContext.me)\n  } catch (err) {\n    if (context.div && context.dom) {\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, err.message))\n    }\n    throw new Error(`Can't log in: ${err}`)\n  }\n  return context\n}\n\n/**\n  * Returns promise of context with arrays of symbols\n  *\n  * leaving the `isPublic` param undefined will bring in community index things, too\n  */\nexport async function findAppInstances (\n  context: AuthenticationContext,\n  theClass: NamedNode,\n  isPublic?: boolean\n): Promise<AuthenticationContext> {\n  let items = context.me ? await getScopedAppInstances(theClass, context.me) : []\n  if (isPublic === true) { // old API - not recommended!\n    items = items.filter(item => item.scope.label === 'public')\n  } else if (isPublic === false) {\n    items = items.filter(item => item.scope.label === 'private')\n  }\n  context.instances = items.map(item => item.instance)\n  return context\n}\n\nexport function scopeLabel (context, scope) {\n  const mine = context.me && context.me.sameTerm(scope.agent)\n  const name = mine ? '' : utils.label(scope.agent) + ' '\n  return `${name}${scope.label}`\n}\n/**\n * UI to control registration of instance\n */\nexport async function registrationControl (\n  context: AuthenticationContext,\n  instance,\n  theClass\n): Promise<AuthenticationContext | void> {\n  function registrationStatements (index) {\n    const registrations = getRegistrations(instance, theClass)\n    const reg = registrations.length ? registrations[0] : widgets.newThing(index)\n    return [\n      st(reg, ns.solid('instance'), instance, index),\n      st(reg, ns.solid('forClass'), theClass, index)\n    ]\n  }\n\n  function renderScopeCheckbox (scope) {\n    const statements = registrationStatements(scope.index)\n    const name = scopeLabel(context, scope)\n    const label = `${name} link to this ${context.noun}`\n    return widgets.buildCheckboxForm(\n      context.dom,\n      solidLogicSingleton.store,\n      label,\n      null,\n      statements,\n      form,\n      scope.index\n    )\n  }\n  /// / body of registrationControl\n  const dom = context.dom\n  if (!dom || !context.div) {\n    throw new Error('registrationControl: need dom and div')\n  }\n  const box = dom.createElement('div')\n  context.div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  const me = context.me\n  if (!me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in to save a link to this)</p>'\n    return context\n  }\n\n  let scopes // @@ const\n  try {\n    scopes = await loadAllTypeIndexes(me)\n  } catch (e) {\n    let msg\n    if (context.div && context.preferencesFileError) {\n      msg = '(Lists of stuff not available)'\n      context.div.appendChild(dom.createElement('p')).textContent = msg\n    } else if (context.div) {\n      msg = `registrationControl: Type indexes not available: ${e}`\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, e))\n    }\n    debug.log(msg)\n    return context\n  }\n\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid gray 0.05em;')\n  const tbody = box.children[0].children[0]\n  const form = new BlankNode() // @@ say for now\n\n  for (const scope of scopes) {\n    const row = tbody.appendChild(dom.createElement('tr'))\n    row.appendChild(renderScopeCheckbox(scope)) // @@ index\n  }\n  return context\n}\n\nexport function renderScopeHeadingRow (context, store, scope) {\n  const backgroundColor = { private: '#fee', public: '#efe' }\n  const { dom } = context\n  const name = scopeLabel(context, scope)\n  const row = dom.createElement('tr')\n  const cell = row.appendChild(dom.createElement('td'))\n  cell.setAttribute('colspan', '3')\n  cell.style.backgoundColor = backgroundColor[scope.label] || 'white'\n  const header = cell.appendChild(dom.createElement('h3'))\n  header.textContent = name + ' links'\n  header.style.textAlign = 'left'\n  return row\n}\n/**\n  * UI to List at all registered things\n  */\nexport async function registrationList (context: AuthenticationContext, options: {\n  private?: boolean\n  public?: boolean\n  type?: NamedNode\n}): Promise<AuthenticationContext> {\n  const dom = context.dom as HTMLDocument\n  const div = context.div as HTMLElement\n\n  const box = dom.createElement('div')\n  div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  if (!context.me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in list your stuff)</p>'\n    return context\n  }\n\n  const scopes = await loadAllTypeIndexes(context.me) // includes community indexes\n\n  // console.log('@@ registrationList ', scopes)\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid #eee 0.5em;')\n  const table = box.firstChild as HTMLElement\n  const tbody = table.firstChild as HTMLElement\n\n  for (const scope of scopes) { // need some predicate for listing/adding agents\n    const headingRow = renderScopeHeadingRow(context, store, scope)\n    tbody.appendChild(headingRow)\n    const items = await getScopedAppsFromIndex(scope, options.type || null) // any class\n    if (items.length === 0) headingRow.style.display = 'none'\n    // console.log(`registrationList: @@ instance items for class ${options.type || 'undefined' }:`, items)\n    for (const item of items) {\n      const row = widgets.personTR(dom, ns.solid('instance'), item.instance, {\n        deleteFunction: async () => {\n          await deleteTypeIndexRegistration(item)\n          tbody.removeChild(row)\n        }\n      })\n      row.children[0].style.paddingLeft = '3em'\n\n      tbody.appendChild(row)\n    }\n  }\n  return context\n} // registrationList\n\n/**\n * Bootstrapping identity\n * (Called by `loginStatusBox()`)\n *\n * @param dom\n * @param setUserCallback\n *\n * @returns\n */\nfunction signInOrSignUpBox (\n  dom: HTMLDocument,\n  setUserCallback: (user: string) => void,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  options = options || {}\n  const signInButtonStyle = options.buttonStyle || style.signInAndUpButtonStyle\n\n  const box: any = dom.createElement('div')\n  const magicClassName = 'SolidSignInOrSignUpBox'\n  debug.log('widgets.signInOrSignUpBox')\n  box.setUserCallback = setUserCallback\n  box.setAttribute('class', magicClassName)\n  box.setAttribute('style', 'display:flex;')\n\n  // Sign in button with PopUP\n  const signInPopUpButton = dom.createElement('input') // multi\n  box.appendChild(signInPopUpButton)\n  signInPopUpButton.setAttribute('type', 'button')\n  signInPopUpButton.setAttribute('value', 'Log in')\n  signInPopUpButton.setAttribute('style', `${signInButtonStyle}${style.headerBannerLoginInput}` + style.signUpBackground)\n\n  authSession.onLogin(() => {\n    const me = authn.currentUser()\n    // const sessionInfo = authSession.info\n    // if (sessionInfo && sessionInfo.isLoggedIn) {\n    if (me) {\n      // const webIdURI = sessionInfo.webId\n      const webIdURI = me.uri\n      // setUserCallback(webIdURI)\n      const divs = dom.getElementsByClassName(magicClassName)\n      debug.log(`Logged in, ${divs.length} panels to be serviced`)\n      // At the same time, satisfy all the other login boxes\n      for (let i = 0; i < divs.length; i++) {\n        const div: any = divs[i]\n        // @@ TODO Remove the need to manipulate HTML elements\n        if (div.setUserCallback) {\n          try {\n            div.setUserCallback(webIdURI)\n            const parent = div.parentNode\n            if (parent) {\n              parent.removeChild(div)\n            }\n          } catch (e) {\n            debug.log(`## Error satisfying login box: ${e}`)\n            div.appendChild(widgets.errorMessageBlock(dom, e))\n          }\n        }\n      }\n    }\n  })\n\n  signInPopUpButton.addEventListener(\n    'click',\n    () => {\n      const offline = offlineTestID()\n      if (offline) return setUserCallback(offline.uri)\n\n      renderSignInPopup(dom)\n    },\n    false\n  )\n\n  // Sign up button\n  const signupButton = dom.createElement('input')\n  box.appendChild(signupButton)\n  signupButton.setAttribute('type', 'button')\n  signupButton.setAttribute('value', 'Sign Up for Solid')\n  signupButton.setAttribute('style', `${signInButtonStyle}${style.headerBannerLoginInput}` + style.signInBackground)\n\n  signupButton.addEventListener(\n    'click',\n    function (_event) {\n      const signupMgr = new Signup()\n      signupMgr.signup().then(function (uri) {\n        debug.log('signInOrSignUpBox signed up ' + uri)\n        setUserCallback(uri)\n      })\n    },\n    false\n  )\n  return box\n}\n\nexport function renderSignInPopup (dom: HTMLDocument) {\n  /**\n   * Issuer Menu\n   */\n  const issuerPopup = dom.createElement('div')\n  issuerPopup.setAttribute(\n    'style',\n    'position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; align-items: center;'\n  )\n  dom.body.appendChild(issuerPopup)\n  const issuerPopupBox = dom.createElement('div')\n  issuerPopupBox.setAttribute(\n    'style',\n    `\n      background-color: white;\n      box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -webkit-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -moz-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -o-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      border-radius: 4px;\n      min-width: 400px;\n      padding: 10px;\n      z-index : 10;\n    `\n  )\n  issuerPopup.appendChild(issuerPopupBox)\n  const issuerPopupBoxTopMenu = dom.createElement('div')\n  issuerPopupBoxTopMenu.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n    `\n  )\n  issuerPopupBox.appendChild(issuerPopupBoxTopMenu)\n  const issuerPopupBoxLabel = dom.createElement('label')\n  issuerPopupBoxLabel.setAttribute('style', 'margin-right: 5px; font-weight: 800')\n  issuerPopupBoxLabel.innerText = 'Select an identity provider'\n  const issuerPopupBoxCloseButton = dom.createElement('button')\n  issuerPopupBoxCloseButton.innerHTML =\n    '<img src=\"https://solidos.github.io/solid-ui/src/icons/noun_1180156.svg\" style=\"width: 2em; height: 2em;\" title=\"Cancel\">'\n  issuerPopupBoxCloseButton.setAttribute('style', 'background-color: transparent; border: none;')\n  issuerPopupBoxCloseButton.addEventListener('click', () => {\n    issuerPopup.remove()\n  })\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxLabel)\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxCloseButton)\n\n  const loginToIssuer = async (issuerUri: string) => {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n      // Save hash\n      const preLoginRedirectHash = new URL(window.location.href).hash\n      if (preLoginRedirectHash) {\n        window.localStorage.setItem('preLoginRedirectHash', preLoginRedirectHash)\n      }\n      window.localStorage.setItem('loginIssuer', issuerUri)\n      // Login\n      const locationUrl = new URL(window.location.href)\n      locationUrl.hash = '' // remove hash part\n      await authSession.login({\n        redirectUrl: locationUrl.href,\n        oidcIssuer: issuerUri\n      })\n    } catch (err) {\n      alert(err.message)\n    }\n  }\n\n  /**\n   * Text-based idp selection\n   */\n  const issuerTextContainer = dom.createElement('div')\n  issuerTextContainer.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerTextInputContainer = dom.createElement('div')\n  issuerTextInputContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: row;\n    `\n  )\n  const issuerTextLabel = dom.createElement('label')\n  issuerTextLabel.innerText = 'Enter the URL of your identity provider:'\n  issuerTextLabel.setAttribute('style', 'color: #888')\n  const issuerTextInput = dom.createElement('input')\n  issuerTextInput.setAttribute('type', 'text')\n  issuerTextInput.setAttribute(\n    'style',\n    'margin-left: 0 !important; flex: 1; margin-right: 5px !important'\n  )\n  issuerTextInput.setAttribute('placeholder', 'https://example.com')\n  issuerTextInput.value = localStorage.getItem('loginIssuer') || ''\n  const issuerTextGoButton = dom.createElement('button')\n  issuerTextGoButton.innerText = 'Go'\n  issuerTextGoButton.setAttribute('style', 'margin-top: 12px; margin-bottom: 12px;')\n  issuerTextGoButton.addEventListener('click', () => {\n    loginToIssuer(issuerTextInput.value)\n  })\n  issuerTextContainer.appendChild(issuerTextLabel)\n  issuerTextInputContainer.appendChild(issuerTextInput)\n  issuerTextInputContainer.appendChild(issuerTextGoButton)\n  issuerTextContainer.appendChild(issuerTextInputContainer)\n  issuerPopupBox.appendChild(issuerTextContainer)\n\n  /**\n   * Button-based idp selection\n   */\n  const issuerButtonContainer = dom.createElement('div')\n  issuerButtonContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerBottonLabel = dom.createElement('label')\n  issuerBottonLabel.innerText = 'Or pick an identity provider from the list below:'\n  issuerBottonLabel.setAttribute('style', 'color: #888')\n  issuerButtonContainer.appendChild(issuerBottonLabel)\n  getSuggestedIssuers().forEach((issuerInfo) => {\n    const issuerButton = dom.createElement('button')\n    issuerButton.innerText = issuerInfo.name\n    issuerButton.setAttribute('style', 'height: 38px; margin-top: 10px')\n    issuerButton.addEventListener('click', () => {\n      loginToIssuer(issuerInfo.uri)\n    })\n    issuerButtonContainer.appendChild(issuerButton)\n  })\n  issuerPopupBox.appendChild(issuerButtonContainer)\n}\n\n/**\n * Login status box\n *\n * A big sign-up/sign in box or a logout box depending on the state\n *\n * @param dom\n * @param listener\n *\n * @returns\n */\nexport function loginStatusBox (\n  dom: HTMLDocument,\n  listener: ((uri: string | null) => void) | null = null,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  // 20190630\n  let me = offlineTestID()\n  // @@ TODO Remove the need to cast HTML element to any\n  const box: any = dom.createElement('div')\n\n  function setIt (newidURI) {\n    if (!newidURI) {\n      return\n    }\n\n    // const uri = newidURI.uri || newidURI\n    // me = sym(uri)\n    me = authn.saveUser(newidURI)\n    box.refresh()\n    if (listener) listener(me!.uri)\n  }\n\n  function logoutButtonHandler (_event) {\n    const oldMe = me\n    authSession.logout().then(\n      function () {\n        const message = `Your WebID was ${oldMe}. It has been forgotten.`\n        me = null\n        try {\n          alert(message)\n        } catch (e) {\n          window.alert(message)\n        }\n        box.refresh()\n        if (listener) listener(null)\n      },\n      (err) => {\n        alert('Fail to log out:' + err)\n      }\n    )\n  }\n\n  function logoutButton (me, options) {\n    const signInButtonStyle = options.buttonStyle || style.signInAndUpButtonStyle\n    let logoutLabel = 'WebID logout'\n    if (me) {\n      const nick =\n        solidLogicSingleton.store.any(me, ns.foaf('nick')) ||\n        solidLogicSingleton.store.any(me, ns.foaf('name'))\n      if (nick) {\n        logoutLabel = 'Logout ' + nick.value\n      }\n    }\n    const signOutButton = dom.createElement('input')\n    // signOutButton.className = 'WebIDCancelButton'\n    signOutButton.setAttribute('type', 'button')\n    signOutButton.setAttribute('value', logoutLabel)\n    signOutButton.setAttribute('style', `${signInButtonStyle}`)\n    signOutButton.addEventListener('click', logoutButtonHandler, false)\n    return signOutButton\n  }\n\n  box.refresh = function () {\n    const sessionInfo = authSession.info\n    if (sessionInfo && sessionInfo.webId && sessionInfo.isLoggedIn) {\n      me = solidLogicSingleton.store.sym(sessionInfo.webId)\n    } else {\n      me = null\n    }\n    if ((me && box.me !== me.uri) || (!me && box.me)) {\n      widgets.clearElement(box)\n      if (me) {\n        box.appendChild(logoutButton(me, options))\n      } else {\n        box.appendChild(signInOrSignUpBox(dom, setIt, options))\n      }\n    }\n    box.me = me ? me.uri : null\n  }\n  box.refresh()\n\n  function trackSession () {\n    me = authn.currentUser()\n    box.refresh()\n  }\n  trackSession()\n\n  authSession.onLogin(trackSession)\n  authSession.onLogout(trackSession)\n  box.me = '99999' // Force refresh\n  box.refresh()\n  return box\n}\n\nauthSession.onLogout(async () => {\n  const issuer = window.localStorage.getItem('loginIssuer')\n  if (issuer) {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n\n      const wellKnownUri = new URL(issuer)\n      wellKnownUri.pathname = '/.well-known/openid-configuration'\n      const wellKnownResult = await fetch(wellKnownUri.toString())\n      if (wellKnownResult.status === 200) {\n        const openidConfiguration = await wellKnownResult.json()\n        if (openidConfiguration && openidConfiguration.end_session_endpoint) {\n          await fetch(openidConfiguration.end_session_endpoint, { credentials: 'include' })\n        }\n      }\n    } catch (err) {\n      // Do nothing\n    }\n  }\n  window.location.reload()\n})\n\n/**\n * Workspace selection etc\n * See https://github.com/solidos/userguide/issues/16\n */\n\n/**\n * Returns a UI object which, if it selects a workspace,\n * will callback(workspace, newBase).\n * See https://github.com/solidos/userguide/issues/16 for more info on workspaces.\n *\n * If necessary, will get an account, preference file, etc. In sequence:\n *\n *   - If not logged in, log in.\n *   - Load preference file\n *   - Prompt user for workspaces\n *   - Allows the user to just type in a URI by hand\n *\n * Calls back with the workspace and the base URI\n *\n * @param dom\n * @param appDetails\n * @param callbackWS\n */\nexport function selectWorkspace (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callbackWS: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const noun = appDetails.noun\n  const appPathSegment = appDetails.appPathSegment\n\n  const me = offlineTestID()\n  const box = dom.createElement('div')\n  const context: AuthenticationContext = { me, dom, div: box }\n\n  function say (s, background) {\n    box.appendChild(widgets.errorMessageBlock(dom, s, background))\n  }\n\n  function figureOutBase (ws) {\n    const newBaseNode: NamedNode = solidLogicSingleton.store.any(\n      ws,\n      ns.space('uriPrefix')\n    ) as NamedNode\n    let newBaseString: string\n    if (!newBaseNode) {\n      newBaseString = ws.uri.split('#')[0]\n    } else {\n      newBaseString = newBaseNode.value\n    }\n    if (newBaseString.slice(-1) !== '/') {\n      debug.log(`${appPathSegment}: No / at end of uriPrefix ${newBaseString}`) // @@ paramater?\n      newBaseString = `${newBaseString}/`\n    }\n    const now = new Date()\n    newBaseString += `${appPathSegment}/id${now.getTime()}/` // unique id\n    return newBaseString\n  }\n\n  function displayOptions (context) {\n    // console.log('displayOptions!', context)\n    async function makeNewWorkspace (_event) {\n      const row = table.appendChild(dom.createElement('tr'))\n      const cell = row.appendChild(dom.createElement('td'))\n      cell.setAttribute('colspan', '3')\n      cell.style.padding = '0.5em'\n      const newBase = encodeURI(\n        await widgets.askName(\n          dom,\n          solidLogicSingleton.store,\n          cell,\n          ns.solid('URL'),\n          ns.space('Workspace'),\n          'Workspace'\n        )\n      )\n      const newWs = widgets.newThing(context.preferencesFile)\n      const newData = [\n        st(context.me, ns.space('workspace'), newWs, context.preferencesFile),\n        // eslint-disable-next-line camelcase\n        st(\n          newWs,\n          ns.space('uriPrefix'),\n          newBase as unknown as Quad_Object,\n          context.preferencesFile\n        )\n      ]\n      if (!solidLogicSingleton.store.updater) {\n        throw new Error('store has no updater')\n      }\n      await solidLogicSingleton.store.updater.update([], newData)\n      // @@ now refresh list of workspaces\n    }\n\n    // const status = ''\n    const id = context.me\n    const preferencesFile = context.preferencesFile\n    let newBase: any = null\n\n    // A workspace specifically defined in the private preference file:\n    let w: any = solidLogicSingleton.store.each(\n      id,\n      ns.space('workspace'),\n      undefined,\n      preferencesFile\n    ) // Only trust preference file here\n\n    // A workspace in a storage in the public profile:\n    const storages = solidLogicSingleton.store.each(id, ns.space('storage')) // @@ No provenance requirement at the moment\n    if (w.length === 0 && storages) {\n      say(\n        `You don't seem to have any workspaces. You have ${storages.length} storage spaces.`,\n        'white'\n      )\n      storages\n        .map(function (s: any) {\n          w = w.concat(solidLogicSingleton.store.each(s, ns.ldp('contains')))\n          return w\n        })\n        .filter((file) => {\n          return file.id ? ['public', 'private'].includes(file.id().toLowerCase()) : ''\n        })\n    }\n\n    if (w.length === 1) {\n      say(`Workspace used: ${w[0].uri}`, 'white') // @@ allow user to see URI\n      newBase = figureOutBase(w[0])\n      // callbackWS(w[0], newBase)\n      // } else if (w.length === 0) {\n    }\n\n    // Prompt for ws selection or creation\n    // say( w.length + \" workspaces for \" + id + \"Choose one.\");\n    const table = dom.createElement('table')\n    table.setAttribute('style', 'border-collapse:separate; border-spacing: 0.5em;')\n\n    // const popup = window.open(undefined, '_blank', { height: 300, width:400 }, false)\n    box.appendChild(table)\n\n    //  Add a field for directly adding the URI yourself\n\n    // const hr = box.appendChild(dom.createElement('hr')) // @@\n    box.appendChild(dom.createElement('hr')) // @@\n\n    const p = box.appendChild(dom.createElement('p'))\n    p.setAttribute('style', style.commentStyle)\n    p.textContent = `Where would you like to store the data for the ${noun}?\n    Give the URL of the folder where you would like the data stored.\n    It can be anywhere in solid world - this URI is just an idea.`\n    // @@ TODO Remove the need to cast baseField to any\n    const baseField: any = box.appendChild(dom.createElement('input'))\n    baseField.setAttribute('type', 'text')\n    baseField.setAttribute('style', style.textInputStyle)\n    baseField.size = 80 // really a string\n    baseField.label = 'base URL'\n    baseField.autocomplete = 'on'\n    if (newBase) {\n      // set to default\n      baseField.value = newBase\n    }\n\n    context.baseField = baseField\n\n    box.appendChild(dom.createElement('br')) // @@\n\n    const button = box.appendChild(dom.createElement('button'))\n    button.setAttribute('style', style.buttonStyle)\n    button.textContent = `Start new ${noun} at this URI`\n    button.addEventListener('click', function (_event) {\n      let newBase = baseField.value.replace(' ', '%20') // do not re-encode in general, as % encodings may exist\n      if (newBase.slice(-1) !== '/') {\n        newBase += '/'\n      }\n      callbackWS(null, newBase)\n    })\n\n    // Now go set up the table of spaces\n\n    // const row = 0\n    w = w.filter(function (x) {\n      return !solidLogicSingleton.store.holds(\n        x,\n        ns.rdf('type'), // Ignore master workspaces\n        ns.space('MasterWorkspace')\n      )\n    })\n    let col1, col2, col3, tr, ws, localStyle, comment\n    const cellStyle = 'height: 3em; margin: 1em; padding: 1em white; border-radius: 0.3em;'\n    const deselectedStyle = `${cellStyle}border: 0px;`\n    // const selectedStyle = cellStyle + 'border: 1px solid black;'\n    for (let i = 0; i < w.length; i++) {\n      ws = w[i]\n      tr = dom.createElement('tr')\n      if (i === 0) {\n        col1 = dom.createElement('td')\n        col1.setAttribute('rowspan', `${w.length}`)\n        col1.textContent = 'Choose a workspace for this:'\n        col1.setAttribute('style', 'vertical-align:middle;')\n        tr.appendChild(col1)\n      }\n      col2 = dom.createElement('td')\n      localStyle = solidLogicSingleton.store.anyValue(ws, ns.ui('style'))\n      if (!localStyle) {\n        // Otherwise make up arbitrary colour\n        const hash = function (x) {\n          return x.split('').reduce(function (a, b) {\n            a = (a << 5) - a + b.charCodeAt(0)\n            return a & a\n          }, 0)\n        }\n        const bgcolor = `#${((hash(ws.uri) & 0xffffff) | 0xc0c0c0).toString(16)}` // c0c0c0  forces pale\n        localStyle = `color: black ; background-color: ${bgcolor};`\n      }\n      col2.setAttribute('style', deselectedStyle + localStyle)\n      tr.target = ws.uri\n      let label = solidLogicSingleton.store.any(ws, ns.rdfs('label'))\n      if (!label) {\n        label = ws.uri.split('/').slice(-1)[0] || ws.uri.split('/').slice(-2)[0]\n      }\n      col2.textContent = label || '???'\n      tr.appendChild(col2)\n      if (i === 0) {\n        col3 = dom.createElement('td')\n        col3.setAttribute('rowspan', `${w.length}1`)\n        // col3.textContent = '@@@@@ remove';\n        col3.setAttribute('style', 'width:50%;')\n        tr.appendChild(col3)\n      }\n      table.appendChild(tr)\n\n      comment = solidLogicSingleton.store.any(ws, ns.rdfs('comment'))\n      comment = comment ? comment.value : 'Use this workspace'\n      col2.addEventListener(\n        'click',\n        function (_event) {\n          col3.textContent = comment ? comment.value : ''\n          col3.setAttribute('style', deselectedStyle + localStyle)\n          const button = dom.createElement('button')\n          button.textContent = 'Continue'\n          // button.setAttribute('style', style);\n          const newBase = figureOutBase(ws)\n          baseField.value = newBase // show user proposed URI\n\n          button.addEventListener(\n            'click',\n            function (_event) {\n              button.disabled = true\n              callbackWS(ws, newBase)\n              button.textContent = '---->'\n            },\n            true\n          ) // capture vs bubble\n          col3.appendChild(button)\n        },\n        true\n      ) // capture vs bubble\n    }\n\n    // last line with \"Make new workspace\"\n    const trLast = dom.createElement('tr')\n    col2 = dom.createElement('td')\n    col2.setAttribute('style', cellStyle)\n    col2.textContent = '+ Make a new workspace'\n    col2.addEventListener('click', makeNewWorkspace)\n    trLast.appendChild(col2)\n    table.appendChild(trLast)\n  } // displayOptions\n\n  // console.log('kicking off async operation')\n  ensureLoadedPreferences(context) // kick off async operation\n    .then(displayOptions)\n    .catch((err) => {\n      // console.log(\"err from async op\")\n      box.appendChild(widgets.errorMessageBlock(context.dom, err))\n    })\n\n  return box // return the box element, while login proceeds\n} // selectWorkspace\n\n/**\n * Creates a new instance of an app.\n *\n * An instance of an app could be e.g. an issue tracker for a given project,\n * or a chess game, or calendar, or a health/fitness record for a person.\n *\n * Note that this use of the term 'app' refers more to entries in the user's\n * type index than to actual software applications that use the personal data\n * to which these entries point.\n *\n * @param dom\n * @param appDetails\n * @param callback\n *\n * @returns A div with a button in it for making a new app instance\n */\nexport function newAppInstance (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callback: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const gotWS = function (ws, base) {\n    // log.debug(\"newAppInstance: Selected workspace = \" + (ws? ws.uri : 'none'))\n    callback(ws, base)\n  }\n  const div = dom.createElement('div')\n  const b = dom.createElement('button')\n  b.setAttribute('type', 'button')\n  div.appendChild(b)\n  b.innerHTML = `Make new ${appDetails.noun}`\n  b.addEventListener(\n    'click',\n    (_event) => {\n      div.appendChild(selectWorkspace(dom, appDetails, gotWS))\n    },\n    false\n  )\n  div.appendChild(b)\n  return div\n}\n/**\n * Retrieves whether the currently logged in user is a power user\n * and/or a developer\n */\nexport async function getUserRoles (): Promise<Array<NamedNode>> {\n  try {\n    const { me, preferencesFile, preferencesFileError } = await ensureLoadedPreferences({})\n    if (!preferencesFile || preferencesFileError) {\n      throw new Error(preferencesFileError)\n    }\n    return solidLogicSingleton.store.each(\n      me,\n      ns.rdf('type'),\n      null,\n      preferencesFile.doc()\n    ) as NamedNode[]\n  } catch (error) {\n    debug.warn('Unable to fetch your preferences - this was the error: ', error)\n  }\n  return []\n}\n\n/**\n * Filters which panes should be available, based on the result of [[getUserRoles]]\n */\nexport async function filterAvailablePanes (\n  panes: Array<PaneDefinition>\n): Promise<Array<PaneDefinition>> {\n  const userRoles = await getUserRoles()\n  return panes.filter((pane) => isMatchingAudience(pane, userRoles))\n}\n\nfunction isMatchingAudience (pane: PaneDefinition, userRoles: Array<NamedNode>): boolean {\n  const audience = pane.audience || []\n  return audience.reduce(\n    (isMatch, audienceRole) => isMatch && !!userRoles.find((role) => role.equals(audienceRole)),\n    true as boolean\n  )\n}\n"],"mappings":"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","ignoreList":[]}