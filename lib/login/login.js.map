{"version":3,"file":"login.js","names":["_rdflib","require","_solidLogic","debug","_interopRequireWildcard","style","_log","ns","_signup","utils","widgets","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t1","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_createForOfIteratorHelper","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","_n","F","s","done","value","TypeError","a","u","next","_arrayLikeToArray","toString","slice","constructor","name","from","test","store","solidLogicSingleton","_solidLogicSingleton$","profile","loadPreferences","loadProfile","_solidLogicSingleton$2","typeIndex","getScopedAppInstances","getRegistrations","loadAllTypeIndexes","getScopedAppsFromIndex","deleteTypeIndexRegistration","ensureLoggedIn","context","me","authn","currentUser","saveUser","Promise","resolve","checkUser","then","webId","log","concat","div","dom","box","loginStatusBox","webIdUri","appendChild","ensureLoadedPreferences","_x","_ensureLoadedPreferences","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee4","progressDisplay","preferencesFile","m2","_t4","wrap","_context4","prev","abrupt","ensureLoadedProfile","sent","parentNode","removeChild","UnauthorizedError","alert","CrossOriginForbiddenError","window","location","origin","preferencesFileError","SameOriginForbiddenError","warn","NotEditableError","WebOperationError","FetchError","status","message","Error","stop","_x2","_ensureLoadedProfile","_callee5","logInContext","_t5","_context5","publicProfile","errorMessageBlock","findAppInstances","_x3","_x4","_x5","_findAppInstances","_callee6","theClass","isPublic","items","_t6","_context6","filter","item","scope","label","instances","map","instance","scopeLabel","mine","sameTerm","agent","registrationControl","_x6","_x7","_x8","_registrationControl","_callee7","registrationStatements","renderScopeCheckbox","scopes","msg","tbody","form","_iterator","_step","row","_t7","_context7","_renderScopeCheckbox","statements","index","noun","buildCheckboxForm","_registrationStatemen","registrations","reg","newThing","st","solid","createElement","innerHTML","textContent","setAttribute","children","BlankNode","err","renderScopeHeadingRow","backgroundColor","cell","backgoundColor","header","textAlign","registrationList","_x9","_x0","_registrationList","_callee9","options","table","_iterator2","_step2","headingRow","_iterator3","_step3","_loop","_t8","_t9","_context0","firstChild","type","display","_context9","personTR","deleteFunction","_deleteFunction","_callee8","_context8","paddingLeft","delegateYield","finish","signInOrSignUpBox","setUserCallback","undefined","signInButtonStyle","buttonStyle","signInAndUpButtonStyle","magicClassName","signInPopUpButton","headerBannerLoginInput","signUpBackground","authSession","onLogin","webIdURI","uri","divs","getElementsByClassName","parent","addEventListener","offline","offlineTestID","renderSignInPopup","signupButton","signInBackground","_event","signupMgr","Signup","signup","issuerPopup","body","issuerPopupBox","issuerPopupBoxTopMenu","issuerPopupBoxLabel","innerText","issuerPopupBoxCloseButton","remove","loginToIssuer","_ref","_callee","issuerUri","preLoginRedirectHash","locationUrl","_t","_context","updater","flagAuthorizationMetadata","URL","href","hash","localStorage","setItem","login","redirectUrl","oidcIssuer","_x1","issuerTextContainer","issuerTextInputContainer","issuerTextLabel","issuerTextInput","getItem","issuerTextGoButton","issuerButtonContainer","issuerBottonLabel","getSuggestedIssuers","forEach","issuerInfo","issuerButton","listener","setIt","newidURI","refresh","logoutButtonHandler","oldMe","logout","logoutButton","logoutLabel","nick","any","foaf","signOutButton","sessionInfo","info","isLoggedIn","sym","clearElement","trackSession","onLogout","_callee2","issuer","wellKnownUri","wellKnownResult","openidConfiguration","_t2","_context2","pathname","fetch","json","end_session_endpoint","credentials","reload","selectWorkspace","appDetails","callbackWS","appPathSegment","say","background","figureOutBase","ws","newBaseNode","space","newBaseString","split","now","Date","getTime","displayOptions","makeNewWorkspace","_x10","_makeNewWorkspace","_callee3","newBase","newWs","newData","_t3","_context3","padding","encodeURI","askName","update","id","w","each","storages","ldp","file","includes","toLowerCase","p","commentStyle","baseField","textInputStyle","size","autocomplete","button","replace","x","holds","rdf","col1","col2","col3","tr","localStyle","comment","cellStyle","deselectedStyle","anyValue","ui","reduce","b","charCodeAt","bgcolor","target","rdfs","disabled","trLast","newAppInstance","callback","gotWS","base","getUserRoles","_getUserRoles","_callee0","_yield$ensureLoadedPr","_t0","_context1","doc","filterAvailablePanes","_x11","_filterAvailablePanes","_callee1","panes","userRoles","_context10","pane","isMatchingAudience","audience","isMatch","audienceRole","find","role","equals"],"sources":["../../src/login/login.ts"],"sourcesContent":["/* eslint-disable camelcase */\n/**\n * Signing in, signing up, profile and preferences reloading\n * Type index management\n *\n * Many functions in this module take a context object which\n * holds various RDF symbols, add to it, and return a promise of it.\n *\n * * `me`                RDF symbol for the user's WebID\n * * `publicProfile`     The user's public profile, iff loaded\n * * `preferencesFile`   The user's personal preference file, iff loaded\n * * `index.public`      The user's public type index file\n * * `index.private`     The user's private type index file\n *\n * Not RDF symbols:\n * * `noun`            A string in english for the type of thing -- like \"address book\"\n * * `instance`        An array of nodes which are existing instances\n * * `containers`      An array of nodes of containers of instances\n * * `div`             A DOM element where UI can be displayed\n * * `statusArea`      A DOM element (opt) progress stuff can be displayed, or error messages\n * *\n * * Vocabulary:  \"load\" loads a file if it exists;\n * *  'Ensure\" CREATES the file if it does not exist (if it can) and then loads it.\n * @packageDocumentation\n */\nimport { PaneDefinition } from 'pane-registry'\nimport { BlankNode, NamedNode, st } from 'rdflib'\n\nimport { Quad_Object } from 'rdflib/lib/tf-types'\nimport {\n  AppDetails,\n  AuthenticationContext,\n  authn,\n  authSession,\n  CrossOriginForbiddenError,\n  FetchError,\n  getSuggestedIssuers,\n  NotEditableError,\n  offlineTestID,\n  SameOriginForbiddenError,\n  solidLogicSingleton,\n  UnauthorizedError,\n  WebOperationError\n} from 'solid-logic'\nimport * as debug from '../debug'\nimport * as style from '../style'\nimport { alert } from '../log'\nimport * as ns from '../ns.js'\nimport { Signup } from '../signup/signup.js'\nimport * as utils from '../utils'\nimport * as widgets from '../widgets'\n\nconst store = solidLogicSingleton.store\n\nconst {\n  loadPreferences,\n  loadProfile\n} = solidLogicSingleton.profile\n\nconst {\n  getScopedAppInstances,\n  getRegistrations,\n  loadAllTypeIndexes,\n  getScopedAppsFromIndex,\n  deleteTypeIndexRegistration\n} = solidLogicSingleton.typeIndex\n\n/**\n * Resolves with the logged in user's WebID\n *\n * @param context\n */\n// used to be logIn\nexport function ensureLoggedIn (context: AuthenticationContext): Promise<AuthenticationContext> {\n  const me = authn.currentUser()\n  if (me) {\n    authn.saveUser(me, context)\n    return Promise.resolve(context)\n  }\n\n  return new Promise((resolve) => {\n    authn.checkUser().then((webId) => {\n      // Already logged in?\n      if (webId) {\n        debug.log(`logIn: Already logged in as ${webId}`)\n        return resolve(context)\n      }\n      if (!context.div || !context.dom) {\n        return resolve(context)\n      }\n      const box = loginStatusBox(context.dom, (webIdUri) => {\n        authn.saveUser(webIdUri, context)\n        resolve(context) // always pass growing context\n      })\n      context.div.appendChild(box)\n    })\n  })\n}\n\n/**\n * Loads preference file\n * Do this after having done log in and load profile\n *\n * @private\n *\n * @param context\n */\n// used to be logInLoadPreferences\nexport async function ensureLoadedPreferences (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.preferencesFile) return Promise.resolve(context) // already done\n\n  // const statusArea = context.statusArea || context.div || null\n  let progressDisplay\n  /* COMPLAIN FUNCTION NOT USED/TAKING IT OUT FOR NOW\n    function complain (message) {\n    message = `ensureLoadedPreferences: ${message}`\n    if (statusArea) {\n      // statusArea.innerHTML = ''\n      statusArea.appendChild(widgets.errorMessageBlock(context.dom, message))\n    }\n    debug.log(message)\n    // reject(new Error(message))\n  } */\n  try {\n    context = await ensureLoadedProfile(context)\n\n    // console.log('back in Solid UI after logInLoadProfile', context)\n    const preferencesFile = await loadPreferences(context.me as NamedNode)\n    if (progressDisplay) {\n      progressDisplay.parentNode.removeChild(progressDisplay)\n    }\n    context.preferencesFile = preferencesFile\n  } catch (err) {\n    let m2: string\n    if (err instanceof UnauthorizedError) {\n      m2 =\n        'Ooops - you are not authenticated (properly logged in) to for me to read your preference file.  Try loggin out and logging in?'\n      alert(m2)\n    } else if (err instanceof CrossOriginForbiddenError) {\n      m2 = `Unauthorized: Assuming preference file blocked for origin ${window.location.origin}`\n      context.preferencesFileError = m2\n      return context\n    } else if (err instanceof SameOriginForbiddenError) {\n      m2 =\n        'You are not authorized to read your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof NotEditableError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n      return context\n    } else if (err instanceof WebOperationError) {\n      m2 =\n        'You are not authorized to edit your preference file. This may be because you are using an untrusted web app.'\n      debug.warn(m2)\n    } else if (err instanceof FetchError) {\n      m2 = `Strange: Error ${err.status} trying to read your preference file.${err.message}`\n      alert(m2)\n    } else {\n      throw new Error(`(via loadPrefs) ${err}`)\n    }\n  }\n  return context\n}\n\n/**\n * Logs the user in and loads their WebID profile document into the store\n *\n * @param context\n *\n * @returns Resolves with the context after login / fetch\n */\n// used to be logInLoadProfile\nexport async function ensureLoadedProfile (\n  context: AuthenticationContext\n): Promise<AuthenticationContext> {\n  if (context.publicProfile) {\n    return context\n  } // already done\n  try {\n    const logInContext = await ensureLoggedIn(context)\n    if (!logInContext.me) {\n      throw new Error('Could not log in')\n    }\n    context.publicProfile = await loadProfile(logInContext.me)\n  } catch (err) {\n    if (context.div && context.dom) {\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, err.message))\n    }\n    throw new Error(`Can't log in: ${err}`)\n  }\n  return context\n}\n\n/**\n  * Returns promise of context with arrays of symbols\n  *\n  * leaving the `isPublic` param undefined will bring in community index things, too\n  */\nexport async function findAppInstances (\n  context: AuthenticationContext,\n  theClass: NamedNode,\n  isPublic?: boolean\n): Promise<AuthenticationContext> {\n  let items = context.me ? await getScopedAppInstances(theClass, context.me) : []\n  if (isPublic === true) { // old API - not recommended!\n    items = items.filter(item => item.scope.label === 'public')\n  } else if (isPublic === false) {\n    items = items.filter(item => item.scope.label === 'private')\n  }\n  context.instances = items.map(item => item.instance)\n  return context\n}\n\nexport function scopeLabel (context, scope) {\n  const mine = context.me && context.me.sameTerm(scope.agent)\n  const name = mine ? '' : utils.label(scope.agent) + ' '\n  return `${name}${scope.label}`\n}\n/**\n * UI to control registration of instance\n */\nexport async function registrationControl (\n  context: AuthenticationContext,\n  instance,\n  theClass\n): Promise<AuthenticationContext | void> {\n  function registrationStatements (index) {\n    const registrations = getRegistrations(instance, theClass)\n    const reg = registrations.length ? registrations[0] : widgets.newThing(index)\n    return [\n      st(reg, ns.solid('instance'), instance, index),\n      st(reg, ns.solid('forClass'), theClass, index)\n    ]\n  }\n\n  function renderScopeCheckbox (scope) {\n    const statements = registrationStatements(scope.index)\n    const name = scopeLabel(context, scope)\n    const label = `${name} link to this ${context.noun}`\n    return widgets.buildCheckboxForm(\n      context.dom,\n      solidLogicSingleton.store,\n      label,\n      null,\n      statements,\n      form,\n      scope.index\n    )\n  }\n  /// / body of registrationControl\n  const dom = context.dom\n  if (!dom || !context.div) {\n    throw new Error('registrationControl: need dom and div')\n  }\n  const box = dom.createElement('div')\n  context.div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  const me = context.me\n  if (!me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in to save a link to this)</p>'\n    return context\n  }\n\n  let scopes // @@ const\n  try {\n    scopes = await loadAllTypeIndexes(me)\n  } catch (e) {\n    let msg\n    if (context.div && context.preferencesFileError) {\n      msg = '(Lists of stuff not available)'\n      context.div.appendChild(dom.createElement('p')).textContent = msg\n    } else if (context.div) {\n      msg = `registrationControl: Type indexes not available: ${e}`\n      context.div.appendChild(widgets.errorMessageBlock(context.dom, e))\n    }\n    debug.log(msg)\n    return context\n  }\n\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid gray 0.05em;')\n  const tbody = box.children[0].children[0]\n  const form = new BlankNode() // @@ say for now\n\n  for (const scope of scopes) {\n    const row = tbody.appendChild(dom.createElement('tr'))\n    row.appendChild(renderScopeCheckbox(scope)) // @@ index\n  }\n  return context\n}\n\nexport function renderScopeHeadingRow (context, store, scope) {\n  const backgroundColor = { private: '#fee', public: '#efe' }\n  const { dom } = context\n  const name = scopeLabel(context, scope)\n  const row = dom.createElement('tr')\n  const cell = row.appendChild(dom.createElement('td'))\n  cell.setAttribute('colspan', '3')\n  cell.style.backgoundColor = backgroundColor[scope.label] || 'white'\n  const header = cell.appendChild(dom.createElement('h3'))\n  header.textContent = name + ' links'\n  header.style.textAlign = 'left'\n  return row\n}\n/**\n  * UI to List at all registered things\n  */\nexport async function registrationList (context: AuthenticationContext, options: {\n  private?: boolean\n  public?: boolean\n  type?: NamedNode\n}): Promise<AuthenticationContext> {\n  const dom = context.dom as HTMLDocument\n  const div = context.div as HTMLElement\n\n  const box = dom.createElement('div')\n  div.appendChild(box)\n  context.me = authn.currentUser() // @@\n  if (!context.me) {\n    box.innerHTML = '<p style=\"margin:2em;\">(Log in list your stuff)</p>'\n    return context\n  }\n\n  const scopes = await loadAllTypeIndexes(context.me) // includes community indexes\n\n  // console.log('@@ registrationList ', scopes)\n  box.innerHTML = '<table><tbody></tbody></table>' // tbody will be inserted anyway\n  box.setAttribute('style', 'font-size: 120%; text-align: right; padding: 1em; border: solid #eee 0.5em;')\n  const table = box.firstChild as HTMLElement\n  const tbody = table.firstChild as HTMLElement\n\n  for (const scope of scopes) { // need some predicate for listing/adding agents\n    const headingRow = renderScopeHeadingRow(context, store, scope)\n    tbody.appendChild(headingRow)\n    const items = await getScopedAppsFromIndex(scope, options.type || null) // any class\n    if (items.length === 0) headingRow.style.display = 'none'\n    // console.log(`registrationList: @@ instance items for class ${options.type || 'undefined' }:`, items)\n    for (const item of items) {\n      const row = widgets.personTR(dom, ns.solid('instance'), item.instance, {\n        deleteFunction: async () => {\n          await deleteTypeIndexRegistration(item)\n          tbody.removeChild(row)\n        }\n      })\n      row.children[0].style.paddingLeft = '3em'\n\n      tbody.appendChild(row)\n    }\n  }\n  return context\n} // registrationList\n\n/**\n * Bootstrapping identity\n * (Called by `loginStatusBox()`)\n *\n * @param dom\n * @param setUserCallback\n *\n * @returns\n */\nfunction signInOrSignUpBox (\n  dom: HTMLDocument,\n  setUserCallback: (user: string) => void,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  options = options || {}\n  const signInButtonStyle = options.buttonStyle || style.signInAndUpButtonStyle\n\n  const box: any = dom.createElement('div')\n  const magicClassName = 'SolidSignInOrSignUpBox'\n  debug.log('widgets.signInOrSignUpBox')\n  box.setUserCallback = setUserCallback\n  box.setAttribute('class', magicClassName)\n  box.setAttribute('style', 'display:flex;')\n\n  // Sign in button with PopUP\n  const signInPopUpButton = dom.createElement('input') // multi\n  box.appendChild(signInPopUpButton)\n  signInPopUpButton.setAttribute('type', 'button')\n  signInPopUpButton.setAttribute('value', 'Log in')\n  signInPopUpButton.setAttribute('style', `${signInButtonStyle}${style.headerBannerLoginInput}` + style.signUpBackground)\n\n  authSession.onLogin(() => {\n    const me = authn.currentUser()\n    // const sessionInfo = authSession.info\n    // if (sessionInfo && sessionInfo.isLoggedIn) {\n    if (me) {\n      // const webIdURI = sessionInfo.webId\n      const webIdURI = me.uri\n      // setUserCallback(webIdURI)\n      const divs = dom.getElementsByClassName(magicClassName)\n      debug.log(`Logged in, ${divs.length} panels to be serviced`)\n      // At the same time, satisfy all the other login boxes\n      for (let i = 0; i < divs.length; i++) {\n        const div: any = divs[i]\n        // @@ TODO Remove the need to manipulate HTML elements\n        if (div.setUserCallback) {\n          try {\n            div.setUserCallback(webIdURI)\n            const parent = div.parentNode\n            if (parent) {\n              parent.removeChild(div)\n            }\n          } catch (e) {\n            debug.log(`## Error satisfying login box: ${e}`)\n            div.appendChild(widgets.errorMessageBlock(dom, e))\n          }\n        }\n      }\n    }\n  })\n\n  signInPopUpButton.addEventListener(\n    'click',\n    () => {\n      const offline = offlineTestID()\n      if (offline) return setUserCallback(offline.uri)\n\n      renderSignInPopup(dom)\n    },\n    false\n  )\n\n  // Sign up button\n  const signupButton = dom.createElement('input')\n  box.appendChild(signupButton)\n  signupButton.setAttribute('type', 'button')\n  signupButton.setAttribute('value', 'Sign Up for Solid')\n  signupButton.setAttribute('style', `${signInButtonStyle}${style.headerBannerLoginInput}` + style.signInBackground)\n\n  signupButton.addEventListener(\n    'click',\n    function (_event) {\n      const signupMgr = new Signup()\n      signupMgr.signup().then(function (uri) {\n        debug.log('signInOrSignUpBox signed up ' + uri)\n        setUserCallback(uri)\n      })\n    },\n    false\n  )\n  return box\n}\n\nexport function renderSignInPopup (dom: HTMLDocument) {\n  /**\n   * Issuer Menu\n   */\n  const issuerPopup = dom.createElement('div')\n  issuerPopup.setAttribute(\n    'style',\n    'position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; align-items: center;'\n  )\n  dom.body.appendChild(issuerPopup)\n  const issuerPopupBox = dom.createElement('div')\n  issuerPopupBox.setAttribute(\n    'style',\n    `\n      background-color: white;\n      box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -webkit-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -moz-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -o-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      border-radius: 4px;\n      min-width: 400px;\n      padding: 10px;\n      z-index : 10;\n    `\n  )\n  issuerPopup.appendChild(issuerPopupBox)\n  const issuerPopupBoxTopMenu = dom.createElement('div')\n  issuerPopupBoxTopMenu.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n    `\n  )\n  issuerPopupBox.appendChild(issuerPopupBoxTopMenu)\n  const issuerPopupBoxLabel = dom.createElement('label')\n  issuerPopupBoxLabel.setAttribute('style', 'margin-right: 5px; font-weight: 800')\n  issuerPopupBoxLabel.innerText = 'Select an identity provider'\n  const issuerPopupBoxCloseButton = dom.createElement('button')\n  issuerPopupBoxCloseButton.innerHTML =\n    '<img src=\"https://solidos.github.io/solid-ui/src/icons/noun_1180156.svg\" style=\"width: 2em; height: 2em;\" title=\"Cancel\">'\n  issuerPopupBoxCloseButton.setAttribute('style', 'background-color: transparent; border: none;')\n  issuerPopupBoxCloseButton.addEventListener('click', () => {\n    issuerPopup.remove()\n  })\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxLabel)\n  issuerPopupBoxTopMenu.appendChild(issuerPopupBoxCloseButton)\n\n  const loginToIssuer = async (issuerUri: string) => {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n      // Save hash\n      const preLoginRedirectHash = new URL(window.location.href).hash\n      if (preLoginRedirectHash) {\n        window.localStorage.setItem('preLoginRedirectHash', preLoginRedirectHash)\n      }\n      window.localStorage.setItem('loginIssuer', issuerUri)\n      // Login\n      const locationUrl = new URL(window.location.href)\n      locationUrl.hash = '' // remove hash part\n      await authSession.login({\n        redirectUrl: locationUrl.href,\n        oidcIssuer: issuerUri\n      })\n    } catch (err) {\n      alert(err.message)\n    }\n  }\n\n  /**\n   * Text-based idp selection\n   */\n  const issuerTextContainer = dom.createElement('div')\n  issuerTextContainer.setAttribute(\n    'style',\n    `\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerTextInputContainer = dom.createElement('div')\n  issuerTextInputContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: row;\n    `\n  )\n  const issuerTextLabel = dom.createElement('label')\n  issuerTextLabel.innerText = 'Enter the URL of your identity provider:'\n  issuerTextLabel.setAttribute('style', 'color: #888')\n  const issuerTextInput = dom.createElement('input')\n  issuerTextInput.setAttribute('type', 'text')\n  issuerTextInput.setAttribute(\n    'style',\n    'margin-left: 0 !important; flex: 1; margin-right: 5px !important'\n  )\n  issuerTextInput.setAttribute('placeholder', 'https://example.com')\n  issuerTextInput.value = localStorage.getItem('loginIssuer') || ''\n  const issuerTextGoButton = dom.createElement('button')\n  issuerTextGoButton.innerText = 'Go'\n  issuerTextGoButton.setAttribute('style', 'margin-top: 12px; margin-bottom: 12px;')\n  issuerTextGoButton.addEventListener('click', () => {\n    loginToIssuer(issuerTextInput.value)\n  })\n  issuerTextContainer.appendChild(issuerTextLabel)\n  issuerTextInputContainer.appendChild(issuerTextInput)\n  issuerTextInputContainer.appendChild(issuerTextGoButton)\n  issuerTextContainer.appendChild(issuerTextInputContainer)\n  issuerPopupBox.appendChild(issuerTextContainer)\n\n  /**\n   * Button-based idp selection\n   */\n  const issuerButtonContainer = dom.createElement('div')\n  issuerButtonContainer.setAttribute(\n    'style',\n    `\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    `\n  )\n  const issuerBottonLabel = dom.createElement('label')\n  issuerBottonLabel.innerText = 'Or pick an identity provider from the list below:'\n  issuerBottonLabel.setAttribute('style', 'color: #888')\n  issuerButtonContainer.appendChild(issuerBottonLabel)\n  getSuggestedIssuers().forEach((issuerInfo) => {\n    const issuerButton = dom.createElement('button')\n    issuerButton.innerText = issuerInfo.name\n    issuerButton.setAttribute('style', 'height: 38px; margin-top: 10px')\n    issuerButton.addEventListener('click', () => {\n      loginToIssuer(issuerInfo.uri)\n    })\n    issuerButtonContainer.appendChild(issuerButton)\n  })\n  issuerPopupBox.appendChild(issuerButtonContainer)\n}\n\n/**\n * Login status box\n *\n * A big sign-up/sign in box or a logout box depending on the state\n *\n * @param dom\n * @param listener\n *\n * @returns\n */\nexport function loginStatusBox (\n  dom: HTMLDocument,\n  listener: ((uri: string | null) => void) | null = null,\n  options: {\n    buttonStyle?: string;\n  } = {}\n): HTMLElement {\n  // 20190630\n  let me = offlineTestID()\n  // @@ TODO Remove the need to cast HTML element to any\n  const box: any = dom.createElement('div')\n\n  function setIt (newidURI) {\n    if (!newidURI) {\n      return\n    }\n\n    // const uri = newidURI.uri || newidURI\n    // me = sym(uri)\n    me = authn.saveUser(newidURI)\n    box.refresh()\n    if (listener) listener(me!.uri)\n  }\n\n  function logoutButtonHandler (_event) {\n    const oldMe = me\n    authSession.logout().then(\n      function () {\n        const message = `Your WebID was ${oldMe}. It has been forgotten.`\n        me = null\n        try {\n          alert(message)\n        } catch (e) {\n          window.alert(message)\n        }\n        box.refresh()\n        if (listener) listener(null)\n      },\n      (err) => {\n        alert('Fail to log out:' + err)\n      }\n    )\n  }\n\n  function logoutButton (me, options) {\n    const signInButtonStyle = options.buttonStyle || style.signInAndUpButtonStyle\n    let logoutLabel = 'WebID logout'\n    if (me) {\n      const nick =\n        solidLogicSingleton.store.any(me, ns.foaf('nick')) ||\n        solidLogicSingleton.store.any(me, ns.foaf('name'))\n      if (nick) {\n        logoutLabel = 'Logout ' + nick.value\n      }\n    }\n    const signOutButton = dom.createElement('input')\n    // signOutButton.className = 'WebIDCancelButton'\n    signOutButton.setAttribute('type', 'button')\n    signOutButton.setAttribute('value', logoutLabel)\n    signOutButton.setAttribute('style', `${signInButtonStyle}`)\n    signOutButton.addEventListener('click', logoutButtonHandler, false)\n    return signOutButton\n  }\n\n  box.refresh = function () {\n    const sessionInfo = authSession.info\n    if (sessionInfo && sessionInfo.webId && sessionInfo.isLoggedIn) {\n      me = solidLogicSingleton.store.sym(sessionInfo.webId)\n    } else {\n      me = null\n    }\n    if ((me && box.me !== me.uri) || (!me && box.me)) {\n      widgets.clearElement(box)\n      if (me) {\n        box.appendChild(logoutButton(me, options))\n      } else {\n        box.appendChild(signInOrSignUpBox(dom, setIt, options))\n      }\n    }\n    box.me = me ? me.uri : null\n  }\n  box.refresh()\n\n  function trackSession () {\n    me = authn.currentUser()\n    box.refresh()\n  }\n  trackSession()\n\n  authSession.onLogin(trackSession)\n  authSession.onLogout(trackSession)\n  box.me = '99999' // Force refresh\n  box.refresh()\n  return box\n}\n\nauthSession.onLogout(async () => {\n  const issuer = window.localStorage.getItem('loginIssuer')\n  if (issuer) {\n    try {\n      // clear authorization metadata from store\n      solidLogicSingleton.store.updater.flagAuthorizationMetadata() as any\n\n      const wellKnownUri = new URL(issuer)\n      wellKnownUri.pathname = '/.well-known/openid-configuration'\n      const wellKnownResult = await fetch(wellKnownUri.toString())\n      if (wellKnownResult.status === 200) {\n        const openidConfiguration = await wellKnownResult.json()\n        if (openidConfiguration && openidConfiguration.end_session_endpoint) {\n          await fetch(openidConfiguration.end_session_endpoint, { credentials: 'include' })\n        }\n      }\n    } catch (err) {\n      // Do nothing\n    }\n  }\n  window.location.reload()\n})\n\n/**\n * Workspace selection etc\n * See https://github.com/solidos/userguide/issues/16\n */\n\n/**\n * Returns a UI object which, if it selects a workspace,\n * will callback(workspace, newBase).\n * See https://github.com/solidos/userguide/issues/16 for more info on workspaces.\n *\n * If necessary, will get an account, preference file, etc. In sequence:\n *\n *   - If not logged in, log in.\n *   - Load preference file\n *   - Prompt user for workspaces\n *   - Allows the user to just type in a URI by hand\n *\n * Calls back with the workspace and the base URI\n *\n * @param dom\n * @param appDetails\n * @param callbackWS\n */\nexport function selectWorkspace (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callbackWS: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const noun = appDetails.noun\n  const appPathSegment = appDetails.appPathSegment\n\n  const me = offlineTestID()\n  const box = dom.createElement('div')\n  const context: AuthenticationContext = { me, dom, div: box }\n\n  function say (s, background) {\n    box.appendChild(widgets.errorMessageBlock(dom, s, background))\n  }\n\n  function figureOutBase (ws) {\n    const newBaseNode: NamedNode = solidLogicSingleton.store.any(\n      ws,\n      ns.space('uriPrefix')\n    ) as NamedNode\n    let newBaseString: string\n    if (!newBaseNode) {\n      newBaseString = ws.uri.split('#')[0]\n    } else {\n      newBaseString = newBaseNode.value\n    }\n    if (newBaseString.slice(-1) !== '/') {\n      debug.log(`${appPathSegment}: No / at end of uriPrefix ${newBaseString}`) // @@ paramater?\n      newBaseString = `${newBaseString}/`\n    }\n    const now = new Date()\n    newBaseString += `${appPathSegment}/id${now.getTime()}/` // unique id\n    return newBaseString\n  }\n\n  function displayOptions (context) {\n    // console.log('displayOptions!', context)\n    async function makeNewWorkspace (_event) {\n      const row = table.appendChild(dom.createElement('tr'))\n      const cell = row.appendChild(dom.createElement('td'))\n      cell.setAttribute('colspan', '3')\n      cell.style.padding = '0.5em'\n      const newBase = encodeURI(\n        await widgets.askName(\n          dom,\n          solidLogicSingleton.store,\n          cell,\n          ns.solid('URL'),\n          ns.space('Workspace'),\n          'Workspace'\n        )\n      )\n      const newWs = widgets.newThing(context.preferencesFile)\n      const newData = [\n        st(context.me, ns.space('workspace'), newWs, context.preferencesFile),\n\n        st(\n          newWs,\n          ns.space('uriPrefix'),\n          newBase as unknown as Quad_Object,\n          context.preferencesFile\n        )\n      ]\n      if (!solidLogicSingleton.store.updater) {\n        throw new Error('store has no updater')\n      }\n      await solidLogicSingleton.store.updater.update([], newData)\n      // @@ now refresh list of workspaces\n    }\n\n    // const status = ''\n    const id = context.me\n    const preferencesFile = context.preferencesFile\n    let newBase: any = null\n\n    // A workspace specifically defined in the private preference file:\n    let w: any = solidLogicSingleton.store.each(\n      id,\n      ns.space('workspace'),\n      undefined,\n      preferencesFile\n    ) // Only trust preference file here\n\n    // A workspace in a storage in the public profile:\n    const storages = solidLogicSingleton.store.each(id, ns.space('storage')) // @@ No provenance requirement at the moment\n    if (w.length === 0 && storages) {\n      say(\n        `You don't seem to have any workspaces. You have ${storages.length} storage spaces.`,\n        'white'\n      )\n      storages\n        .map(function (s: any) {\n          w = w.concat(solidLogicSingleton.store.each(s, ns.ldp('contains')))\n          return w\n        })\n        .filter((file) => {\n          return file.id ? ['public', 'private'].includes(file.id().toLowerCase()) : ''\n        })\n    }\n\n    if (w.length === 1) {\n      say(`Workspace used: ${w[0].uri}`, 'white') // @@ allow user to see URI\n      newBase = figureOutBase(w[0])\n      // callbackWS(w[0], newBase)\n      // } else if (w.length === 0) {\n    }\n\n    // Prompt for ws selection or creation\n    // say( w.length + \" workspaces for \" + id + \"Choose one.\");\n    const table = dom.createElement('table')\n    table.setAttribute('style', 'border-collapse:separate; border-spacing: 0.5em;')\n\n    // const popup = window.open(undefined, '_blank', { height: 300, width:400 }, false)\n    box.appendChild(table)\n\n    //  Add a field for directly adding the URI yourself\n\n    // const hr = box.appendChild(dom.createElement('hr')) // @@\n    box.appendChild(dom.createElement('hr')) // @@\n\n    const p = box.appendChild(dom.createElement('p'))\n    p.setAttribute('style', style.commentStyle)\n    p.textContent = `Where would you like to store the data for the ${noun}?\n    Give the URL of the folder where you would like the data stored.\n    It can be anywhere in solid world - this URI is just an idea.`\n    // @@ TODO Remove the need to cast baseField to any\n    const baseField: any = box.appendChild(dom.createElement('input'))\n    baseField.setAttribute('type', 'text')\n    baseField.setAttribute('style', style.textInputStyle)\n    baseField.size = 80 // really a string\n    baseField.label = 'base URL'\n    baseField.autocomplete = 'on'\n    if (newBase) {\n      // set to default\n      baseField.value = newBase\n    }\n\n    context.baseField = baseField\n\n    box.appendChild(dom.createElement('br')) // @@\n\n    const button = box.appendChild(dom.createElement('button'))\n    button.setAttribute('style', style.buttonStyle)\n    button.textContent = `Start new ${noun} at this URI`\n    button.addEventListener('click', function (_event) {\n      let newBase = baseField.value.replace(' ', '%20') // do not re-encode in general, as % encodings may exist\n      if (newBase.slice(-1) !== '/') {\n        newBase += '/'\n      }\n      callbackWS(null, newBase)\n    })\n\n    // Now go set up the table of spaces\n\n    // const row = 0\n    w = w.filter(function (x) {\n      return !solidLogicSingleton.store.holds(\n        x,\n        ns.rdf('type'), // Ignore master workspaces\n        ns.space('MasterWorkspace')\n      )\n    })\n    let col1, col2, col3, tr, ws, localStyle, comment\n    const cellStyle = 'height: 3em; margin: 1em; padding: 1em white; border-radius: 0.3em;'\n    const deselectedStyle = `${cellStyle}border: 0px;`\n    // const selectedStyle = cellStyle + 'border: 1px solid black;'\n    for (let i = 0; i < w.length; i++) {\n      ws = w[i]\n      tr = dom.createElement('tr')\n      if (i === 0) {\n        col1 = dom.createElement('td')\n        col1.setAttribute('rowspan', `${w.length}`)\n        col1.textContent = 'Choose a workspace for this:'\n        col1.setAttribute('style', 'vertical-align:middle;')\n        tr.appendChild(col1)\n      }\n      col2 = dom.createElement('td')\n      localStyle = solidLogicSingleton.store.anyValue(ws, ns.ui('style'))\n      if (!localStyle) {\n        // Otherwise make up arbitrary colour\n        const hash = function (x) {\n          return x.split('').reduce(function (a, b) {\n            a = (a << 5) - a + b.charCodeAt(0)\n            return a & a\n          }, 0)\n        }\n        const bgcolor = `#${((hash(ws.uri) & 0xffffff) | 0xc0c0c0).toString(16)}` // c0c0c0  forces pale\n        localStyle = `color: black ; background-color: ${bgcolor};`\n      }\n      col2.setAttribute('style', deselectedStyle + localStyle)\n      tr.target = ws.uri\n      let label = solidLogicSingleton.store.any(ws, ns.rdfs('label'))\n      if (!label) {\n        label = ws.uri.split('/').slice(-1)[0] || ws.uri.split('/').slice(-2)[0]\n      }\n      col2.textContent = label || '???'\n      tr.appendChild(col2)\n      if (i === 0) {\n        col3 = dom.createElement('td')\n        col3.setAttribute('rowspan', `${w.length}1`)\n        // col3.textContent = '@@@@@ remove';\n        col3.setAttribute('style', 'width:50%;')\n        tr.appendChild(col3)\n      }\n      table.appendChild(tr)\n\n      comment = solidLogicSingleton.store.any(ws, ns.rdfs('comment'))\n      comment = comment ? comment.value : 'Use this workspace'\n      col2.addEventListener(\n        'click',\n        function (_event) {\n          col3.textContent = comment ? comment.value : ''\n          col3.setAttribute('style', deselectedStyle + localStyle)\n          const button = dom.createElement('button')\n          button.textContent = 'Continue'\n          // button.setAttribute('style', style);\n          const newBase = figureOutBase(ws)\n          baseField.value = newBase // show user proposed URI\n\n          button.addEventListener(\n            'click',\n            function (_event) {\n              button.disabled = true\n              callbackWS(ws, newBase)\n              button.textContent = '---->'\n            },\n            true\n          ) // capture vs bubble\n          col3.appendChild(button)\n        },\n        true\n      ) // capture vs bubble\n    }\n\n    // last line with \"Make new workspace\"\n    const trLast = dom.createElement('tr')\n    col2 = dom.createElement('td')\n    col2.setAttribute('style', cellStyle)\n    col2.textContent = '+ Make a new workspace'\n    col2.addEventListener('click', makeNewWorkspace)\n    trLast.appendChild(col2)\n    table.appendChild(trLast)\n  } // displayOptions\n\n  // console.log('kicking off async operation')\n  ensureLoadedPreferences(context) // kick off async operation\n    .then(displayOptions)\n    .catch((err) => {\n      // console.log(\"err from async op\")\n      box.appendChild(widgets.errorMessageBlock(context.dom, err))\n    })\n\n  return box // return the box element, while login proceeds\n} // selectWorkspace\n\n/**\n * Creates a new instance of an app.\n *\n * An instance of an app could be e.g. an issue tracker for a given project,\n * or a chess game, or calendar, or a health/fitness record for a person.\n *\n * Note that this use of the term 'app' refers more to entries in the user's\n * type index than to actual software applications that use the personal data\n * to which these entries point.\n *\n * @param dom\n * @param appDetails\n * @param callback\n *\n * @returns A div with a button in it for making a new app instance\n */\nexport function newAppInstance (\n  dom: HTMLDocument,\n  appDetails: AppDetails,\n  callback: (workspace: string | null, newBase: string) => void\n): HTMLElement {\n  const gotWS = function (ws, base) {\n    // log.debug(\"newAppInstance: Selected workspace = \" + (ws? ws.uri : 'none'))\n    callback(ws, base)\n  }\n  const div = dom.createElement('div')\n  const b = dom.createElement('button')\n  b.setAttribute('type', 'button')\n  div.appendChild(b)\n  b.innerHTML = `Make new ${appDetails.noun}`\n  b.addEventListener(\n    'click',\n    (_event) => {\n      div.appendChild(selectWorkspace(dom, appDetails, gotWS))\n    },\n    false\n  )\n  div.appendChild(b)\n  return div\n}\n/**\n * Retrieves whether the currently logged in user is a power user\n * and/or a developer\n */\nexport async function getUserRoles (): Promise<Array<NamedNode>> {\n  try {\n    const { me, preferencesFile, preferencesFileError } = await ensureLoadedPreferences({})\n    if (!preferencesFile || preferencesFileError) {\n      throw new Error(preferencesFileError)\n    }\n    return solidLogicSingleton.store.each(\n      me,\n      ns.rdf('type'),\n      null,\n      preferencesFile.doc()\n    ) as NamedNode[]\n  } catch (error) {\n    debug.warn('Unable to fetch your preferences - this was the error: ', error)\n  }\n  return []\n}\n\n/**\n * Filters which panes should be available, based on the result of [[getUserRoles]]\n */\nexport async function filterAvailablePanes (\n  panes: Array<PaneDefinition>\n): Promise<Array<PaneDefinition>> {\n  const userRoles = await getUserRoles()\n  return panes.filter((pane) => isMatchingAudience(pane, userRoles))\n}\n\nfunction isMatchingAudience (pane: PaneDefinition, userRoles: Array<NamedNode>): boolean {\n  const audience = pane.audience || []\n  return audience.reduce(\n    (isMatch, audienceRole) => isMatch && !!userRoles.find((role) => role.equals(audienceRole)),\n    true as boolean\n  )\n}\n"],"mappings":"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","ignoreList":[]}