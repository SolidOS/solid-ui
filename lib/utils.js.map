{"version":3,"sources":["../src/utils.js"],"names":["module","exports","addLoadEvent","AJARImage","ancestor","beep","clearVariableNames","emptyNode","escapeForXML","findPos","genUuid","getAbout","getEyeFocus","getTarget","getTerm","hashColor","include","label","labelForXML","labelWithOntology","newVariableName","ontologyLabel","predicateLabelForXML","predParentOf","RDFComparePredicateObject","RDFComparePredicateSubject","shortName","stackString","syncTableToArray","syncTableToArrayReOrdered","UI","log","require","ns","rdf","store","nextVariable","audioContext","AudioContext","window","webkitAudioContext","ContextClass","ctx","duration","frequency","type","finishedCallback","osc","createOscillator","value","connect","destination","start","stop","who","uri","hash","x","split","reduce","a","b","charCodeAt","toString","replace","c","r","Math","random","v","table","things","createNewRow","foundOne","row","i","children","length","trashMe","g","thing","subject","sameTerm","newRow","appendChild","ele","insertBefore","removeChild","elementMap","toNT","existingRow","before","e","str","stack","lines","toPrint","line","indexOf","charAt","chunks","push","node","nodes","childNodes","len","target","event","srcElement","nodeType","parentNode","tagName","level","undefined","kb","aa","getAttribute","fromNT","debug","statementTr","st","AJAR_statement","className","predicate","AJAR_inverse","object","nextSibling","document","linkstr","lnk","createElement","setAttribute","func","oldonload","onload","obj","myDocument","ownerDocument","DocBox","documentElement","getBoundingClientRect","box","left","top","element","instantly","isBottom","myWindow","elementPosY","totalScroll","scrollY","scrollBy","clientHeight","innerHeight","id","setInterval","scrollAmount","times","clearInterval","src","alt","tt","doc","image","addEventListener","clipboardData","setData","preventDefault","p","slice","namespaces","prefixes","pok","canUse","pp","lastIndexOf","slash","prefixchars","term","s","part","initialCap","t","findTypeURIs","rdfs","doCap","toUpperCase","cleanUp","s1","s2","toLowerCase","lab1","any","link","vcard","foaf","dct","dc","rss","contact","sym","cal","termType","elements","map","decodeURIComponent","join","hex","String","fromCharCode","parseInt","inverse","lab","ip","owl","self","other","compareTerm","n","previousSibling","nodeName","error"],"mappings":"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","sourcesContent":["//                  Solid-UI general Utilities\n//                  ==========================\n//\n// This must load AFTER the rdflib.js and log-ext.js (or log.js).\n//\n\nmodule.exports = {\n  addLoadEvent, // not used anywhere\n  AJARImage,\n  ancestor,\n  beep,\n  clearVariableNames,\n  emptyNode,\n  escapeForXML,\n  findPos,\n  genUuid,\n  getAbout,\n  getEyeFocus,\n  getTarget,\n  getTerm,\n  hashColor,\n  include,\n  label,\n  labelForXML,\n  labelWithOntology,\n  newVariableName,\n  ontologyLabel,\n  predicateLabelForXML,\n  predParentOf,\n  RDFComparePredicateObject,\n  RDFComparePredicateSubject,\n  shortName,\n  stackString,\n  syncTableToArray,\n  syncTableToArrayReOrdered\n}\n\nvar UI = {\n  log: require('./log'),\n  ns: require('./ns'),\n  rdf: require('rdflib'),\n  store: require('./store')\n}\n\nvar nextVariable = 0\n\nfunction newVariableName () {\n  return 'v' + nextVariable++\n}\n\nfunction clearVariableNames () {\n  nextVariable = 0\n}\n\n// http://stackoverflow.com/questions/879152/how-do-i-make-javascript-beep\n// http://www.tsheffler.com/blog/2013/05/14/audiocontext-noteonnoteoff-and-time-units/\n\nvar audioContext\n\nif (typeof AudioContext !== 'undefined') {\n  audioContext = AudioContext\n} else if (typeof window !== 'undefined') {\n  audioContext = window.AudioContext || window.webkitAudioContext\n}\n\nfunction beep () {\n  if (!audioContext) {\n    return\n  } // Safari 2015\n\n  const ContextClass = audioContext\n  const ctx = new ContextClass()\n\n  return function (duration, frequency, type, finishedCallback) {\n    duration = +(duration || 0.3)\n\n    // Only 0-4 are valid types.\n    type = type || 'sine' // sine, square, sawtooth, triangle\n\n    if (typeof finishedCallback !== 'function') {\n      finishedCallback = function () {}\n    }\n\n    var osc = ctx.createOscillator()\n\n    osc.type = type\n    osc.frequency.value = frequency || 256\n\n    osc.connect(ctx.destination)\n    osc.start(0)\n    osc.stop(duration)\n  }\n}\n\n// Make pseudorandom color from a uri\n// NOT USED ANYWHERE\nfunction hashColor (who) {\n  who = who.uri || who\n  var hash = function (x) {\n    return x.split('').reduce(function (a, b) {\n      a = (a << 5) - a + b.charCodeAt(0)\n      return a & a\n    }, 0)\n  }\n  return '#' + ((hash(who) & 0xffffff) | 0xc0c0c0).toString(16) // c0c0c0 or 808080 forces pale\n}\n\nfunction genUuid () {\n  // http://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = (Math.random() * 16) | 0\n    var v = c === 'x' ? r : (r & 0x3) | 0x8\n    return v.toString(16)\n  })\n}\n\n/** Sync a DOM table with an array of things\n *\n * @param {DomElement} table - will have a tr for each thing\n * @param {Array<NamedNode>} things - ORDERED array of NamedNode objects\n * @param {function({NamedNode})} createNewRow(thing) returns a TR table row for a new thing\n *\n * Tolerates out of order elements but puts new ones in order.\n * Can be used for any element type; does not have to be a table and tr.\n */\nfunction syncTableToArray (table, things, createNewRow) {\n  let foundOne\n  let row\n  let i\n\n  for (i = 0; i < table.children.length; i++) {\n    row = table.children[i]\n    row.trashMe = true\n  }\n\n  for (let g = 0; g < things.length; g++) {\n    var thing = things[g]\n    foundOne = false\n\n    for (i = 0; i < table.children.length; i++) {\n      row = table.children[i]\n      if (row.subject && row.subject.sameTerm(thing)) {\n        row.trashMe = false\n        foundOne = true\n        break\n      }\n    }\n    if (!foundOne) {\n      const newRow = createNewRow(thing)\n      // Insert new row in position g in the table to match array\n      if (g >= table.children.length) {\n        table.appendChild(newRow)\n      } else {\n        const ele = table.children[g]\n        table.insertBefore(newRow, ele)\n      }\n      newRow.subject = thing\n    } // if not foundOne\n  } // loop g\n\n  for (i = 0; i < table.children.length; i++) {\n    row = table.children[i]\n    if (row.trashMe) {\n      table.removeChild(row)\n    }\n  }\n} // syncTableToArray\n\n/** Sync a DOM table with an array of things\n *\n * @param {DomElement} table - will have a tr for each thing\n * @param {Array<NamedNode>} things - ORDERED array of UNIQUE NamedNode objects. No duplicates\n * @param {function({NamedNode})} createNewRow(thing) returns a rendering of a new thing\n *\n * Ensures order matches exacly.  We will re-rder existing elements if necessary\n * Can be used for any element type; does not have to be a table and tr.\n * Any RDF node value can only appear ONCE in the array\n */\nfunction syncTableToArrayReOrdered (table, things, createNewRow) {\n  const elementMap = {}\n\n  for (let i = 0; i < table.children.length; i++) {\n    const row = table.children[i]\n    elementMap[row.subject.toNT()] = row // More sophisticaed would be to have a bag of duplicates\n  }\n\n  for (let g = 0; g < things.length; g++) {\n    var thing = things[g]\n    if (g >= table.children.length) { // table needs extending\n      const newRow = createNewRow(thing)\n      newRow.subject = thing\n      table.appendChild(newRow)\n    } else {\n      const row = table.children[g]\n      if (row.subject.sameTerm(thing)) {\n      } else {\n        const existingRow = elementMap[thing.toNT()]\n        if (existingRow) {\n          table.removeChild(existingRow)\n          table.insertBefore(existingRow, row) // Insert existing row in place of this one\n        } else {\n          const newRow = createNewRow(thing)\n          row.before(newRow) // Insert existing row in place of this one\n          newRow.subject = thing\n        }\n      }\n    }\n  } // loop g\n  // Lop off any we don't need any more:\n  while (table.children.length > things.length) {\n    table.removeChild(table.children[table.children.length - 1])\n  }\n} // syncTableToArrayReOrdered\n\n/* Error stack to string for better diagnotsics\n **\n ** See  http://snippets.dzone.com/posts/show/6632\n */\nfunction stackString (e) {\n  let str = '' + e + '\\n'\n  let i\n  if (!e.stack) {\n    return str + 'No stack available.\\n'\n  }\n  const lines = e.stack.toString().split('\\n')\n  const toPrint = []\n  for (i = 0; i < lines.length; i++) {\n    let line = lines[i]\n    if (line.indexOf('ecmaunit.js') > -1) {\n      // remove useless bit of traceback\n      break\n    }\n    if (line.charAt(0) === '(') {\n      line = 'function' + line\n    }\n    const chunks = line.split('@')\n    toPrint.push(chunks)\n  }\n  // toPrint.reverse();  No - I prefer the latest at the top by the error message -tbl\n\n  for (i = 0; i < toPrint.length; i++) {\n    str += '  ' + toPrint[i][1] + '\\n    ' + toPrint[i][0]\n  }\n  return str\n}\n\nfunction emptyNode (node) {\n  const nodes = node.childNodes\n  const len = nodes.length\n  for (let i = len - 1; i >= 0; i--) node.removeChild(nodes[i])\n  return node\n}\n\nfunction getTarget (e) {\n  var target\n  e = e || window.event\n  if (e.target) target = e.target\n  else if (e.srcElement) target = e.srcElement\n  if (target.nodeType === 3) {\n    // defeat Safari bug [sic]\n    target = target.parentNode\n  }\n  // UI.log.debug(\"Click on: \" + target.tagName)\n  return target\n}\n\nfunction ancestor (target, tagName) {\n  var level\n  for (level = target; level; level = level.parentNode) {\n    // UI.log.debug(\"looking for \"+tagName+\" Level: \"+level+\" \"+level.tagName)\n    try {\n      if (level.tagName === tagName) return level\n    } catch (e) {\n      // can hit \"TypeError: can't access dead object\" in ffox\n      return undefined\n    }\n  }\n  return undefined\n}\n\nfunction getAbout (kb, target) {\n  var level, aa\n  for (\n    level = target;\n    level && level.nodeType === 1;\n    level = level.parentNode\n  ) {\n    // UI.log.debug(\"Level \"+level + ' '+level.nodeType + ': '+level.tagName)\n    aa = level.getAttribute('about')\n    if (aa) {\n      // UI.log.debug(\"kb.fromNT(aa) = \" + kb.fromNT(aa))\n      return kb.fromNT(aa)\n      //        } else {\n      //            if (level.tagName=='TR') return undefined//this is to prevent literals passing through\n    }\n  }\n  UI.log.debug('getAbout: No about found')\n  return undefined\n}\n\nfunction getTerm (target) {\n  var statementTr = target.parentNode\n  var st = statementTr ? statementTr.AJAR_statement : undefined\n\n  var className = st ? target.className : '' // if no st then it's necessary to use getAbout\n  switch (className) {\n    case 'pred':\n    case 'pred selected':\n      return st.predicate\n    case 'obj':\n    case 'obj selected':\n      if (!statementTr.AJAR_inverse) {\n        return st.object\n      } else {\n        return st.subject\n      }\n    case '':\n    case 'selected': // header TD\n      return getAbout(UI.store, target) // kb to be changed\n    case 'undetermined selected':\n      return target.nextSibling\n        ? st.predicate\n        : !statementTr.AJAR_inverse\n          ? st.object\n          : st.subject\n  }\n}\n\nfunction include (document, linkstr) {\n  var lnk = document.createElement('script')\n  lnk.setAttribute('type', 'text/javascript')\n  lnk.setAttribute('src', linkstr)\n  // TODO:This needs to be fixed or no longer used.\n  // document.getElementsByTagName('head')[0].appendChild(lnk)\n  return lnk\n}\n\nfunction addLoadEvent (func) {\n  var oldonload = window.onload\n  if (typeof window.onload !== 'function') {\n    window.onload = func\n  } else {\n    window.onload = function () {\n      oldonload()\n      func()\n    }\n  }\n} // addLoadEvent\n\n// Find the position of an object relative to the window\nfunction findPos (obj) {\n  // C&P from http://www.quirksmode.org/js/findpos.html\n  var myDocument = obj.ownerDocument\n  var DocBox = myDocument.documentElement.getBoundingClientRect()\n  var box = obj.getBoundingClientRect()\n  return [box.left - DocBox.left, box.top - DocBox.top]\n}\n\nfunction getEyeFocus (element, instantly, isBottom, myWindow) {\n  if (!myWindow) myWindow = window\n  var elementPosY = findPos(element)[1]\n  var totalScroll = elementPosY - 52 - myWindow.scrollY // magic number 52 for web-based version\n  if (instantly) {\n    if (isBottom) {\n      myWindow.scrollBy(\n        0,\n        elementPosY +\n          element.clientHeight -\n          (myWindow.scrollY + myWindow.innerHeight)\n      )\n      return\n    }\n    myWindow.scrollBy(0, totalScroll)\n    return\n  }\n  var id = myWindow.setInterval(scrollAmount, 50)\n  var times = 0\n  function scrollAmount () {\n    myWindow.scrollBy(0, totalScroll / 10)\n    times++\n    if (times === 10) {\n      myWindow.clearInterval(id)\n    }\n  }\n}\n\nfunction AJARImage (src, alt, tt, doc) {\n  if (!doc) {\n    doc = document\n  }\n  var image = doc.createElement('img')\n  image.setAttribute('src', src)\n  image.addEventListener('copy', function (e) {\n    e.clipboardData.setData('text/plain', '')\n    e.clipboardData.setData('text/html', '')\n    e.preventDefault() // We want no title data to be written to the clipboard\n  })\n  //    if (typeof alt != 'undefined')      // Messes up cut-and-paste of text\n  //        image.setAttribute('alt', alt)\n  if (typeof tt !== 'undefined') {\n    image.setAttribute('title', tt)\n  }\n  return image\n}\n\n//  Make short name for ontology\n\nfunction shortName (uri) {\n  let p = uri\n  if ('#/'.indexOf(p[p.length - 1]) >= 0) p = p.slice(0, -1)\n  const namespaces = []\n  for (const ns in this.prefixes) {\n    namespaces[this.prefixes[ns]] = ns // reverse index\n  }\n  let pok\n  const canUse = function canUse (pp) {\n    // if (!__Serializer.prototype.validPrefix.test(pp)) return false; // bad format\n    if (pp === 'ns') return false // boring\n    // if (pp in this.namespaces) return false; // already used\n    // this.prefixes[uri] = pp;\n    // this.namespaces[pp] = uri;\n    pok = pp\n    return true\n  }\n\n  let i\n  const hash = p.lastIndexOf('#')\n  if (hash >= 0) p = p.slice(hash - 1) // lop off localid\n  for (;;) {\n    const slash = p.lastIndexOf('/')\n    if (slash >= 0) p = p.slice(slash + 1)\n    i = 0\n    while (i < p.length) {\n      if (this.prefixchars.indexOf(p[i])) i++\n      else break\n    }\n    p = p.slice(0, i)\n    if (p.length < 6 && canUse(p)) return pok // exact i sbest\n    if (canUse(p.slice(0, 3))) return pok\n    if (canUse(p.slice(0, 2))) return pok\n    if (canUse(p.slice(0, 4))) return pok\n    if (canUse(p.slice(0, 1))) return pok\n    if (canUse(p.slice(0, 5))) return pok\n    for (i = 0; ; i++) if (canUse(p.slice(0, 3) + i)) return pok\n  }\n}\n\n// Short name for an ontology\nfunction ontologyLabel (term) {\n  if (term.uri === undefined) return '??'\n  var s = term.uri\n  var namespaces = []\n  var i = s.lastIndexOf('#')\n  var part\n  if (i >= 0) {\n    s = s.slice(0, i + 1)\n  } else {\n    i = s.lastIndexOf('/')\n    if (i >= 0) {\n      s = s.slice(0, i + 1)\n    } else {\n      return term.uri + '?!' // strange should have # or /\n    }\n  }\n  for (const ns in UI.ns) {\n    namespaces[UI.ns[ns]] = ns // reverse index\n  }\n  try {\n    return namespaces[s]\n  } catch (e) {}\n\n  s = s.slice(0, -1) // Chop off delimiter ... now have just\n\n  while (s) {\n    i = s.lastIndexOf('/')\n    if (i >= 0) {\n      part = s.slice(i + 1)\n      s = s.slice(0, i)\n      if (part !== 'ns' && '0123456789'.indexOf(part[0]) < 0) {\n        return part\n      }\n    } else {\n      return term.uri + '!?' // strange should have a nice part\n    }\n  }\n}\n\nfunction labelWithOntology (x, initialCap) {\n  const t = UI.store.findTypeURIs(x)\n  if (t[UI.ns.rdf('Predicate').uri] || t[UI.ns.rdfs('Class').uri]) {\n    return label(x, initialCap) + ' (' + ontologyLabel(x) + ')'\n  }\n  return label(x, initialCap)\n}\n\n// This ubiquitous function returns the best label for a thing\n//\n//  The hacks in this code make a major difference to the usability\n//\n// @returns string\n//\nfunction label (x, initialCap) {\n  // x is an object\n  function doCap (s) {\n    // s = s.toString()\n    if (initialCap) return s.slice(0, 1).toUpperCase() + s.slice(1)\n    return s\n  }\n  function cleanUp (s1) {\n    var s2 = ''\n    if (s1.slice(-1) === '/') s1 = s1.slice(0, -1) // chop trailing slash\n    for (var i = 0; i < s1.length; i++) {\n      if (s1[i] === '_' || s1[i] === '-') {\n        s2 += ' '\n        continue\n      }\n      s2 += s1[i]\n      if (\n        i + 1 < s1.length &&\n        s1[i].toUpperCase() !== s1[i] &&\n        s1[i + 1].toLowerCase() !== s1[i + 1]\n      ) {\n        s2 += ' '\n      }\n    }\n    if (s2.slice(0, 4) === 'has ') s2 = s2.slice(4)\n    return doCap(s2)\n  }\n\n  // The tabulator labeler is more sophisticated if it exists\n  // Todo: move it to a solid-ui option.\n  /*\n  var lab\n  if (typeof tabulator !== 'undefined' && tabulator.lb) {\n    lab = tabulator.lb.label(x)\n    if (lab) {\n      return doCap(lab.value)\n    }\n  }\n  */\n  // Hard coded known label predicates\n  //  @@ TBD: Add subproperties of rdfs:label\n\n  var kb = UI.store\n  var lab1 =\n    kb.any(x, UI.ns.link('message')) ||\n    kb.any(x, UI.ns.vcard('fn')) ||\n    kb.any(x, UI.ns.foaf('name')) ||\n    kb.any(x, UI.ns.dct('title')) ||\n    kb.any(x, UI.ns.dc('title')) ||\n    kb.any(x, UI.ns.rss('title')) ||\n    kb.any(x, UI.ns.contact('fullName')) ||\n    kb.any(x, kb.sym('http://www.w3.org/2001/04/roadmap/org#name')) ||\n    kb.any(x, UI.ns.cal('summary')) ||\n    kb.any(x, UI.ns.foaf('nick')) ||\n    kb.any(x, UI.ns.rdfs('label'))\n\n  if (lab1) {\n    return doCap(lab1.value)\n  }\n\n  // Default to label just generated from the URI\n\n  if (x.termType === 'BlankNode') {\n    return '...'\n  }\n  if (x.termType === 'Collection') {\n    return '(' + x.elements.length + ')'\n  }\n  var s = x.uri\n  if (typeof s === 'undefined') return x.toString() // can't be a symbol\n  // s = decodeURI(s) // This can crash is random valid @ signs are presentation\n  // The idea was to clean up eg URIs encoded in query strings\n  // Also encoded character in what was filenames like @ [] {}\n  try {\n    s = s\n      .split('/')\n      .map(decodeURIComponent)\n      .join('/') // If it is properly encoded\n  } catch (e) {\n    // try individual decoding of ASCII code points\n    for (var i = s.length - 3; i > 0; i--) {\n      const hex = '0123456789abcefABCDEF' // The while upacks multiple layers of encoding\n      while (\n        s[i] === '%' &&\n        hex.indexOf(s[i + 1]) >= 0 &&\n        hex.indexOf(s[i + 2]) >= 0\n      ) {\n        s =\n          s.slice(0, i) +\n          String.fromCharCode(parseInt(s.slice(i + 1, i + 3), 16)) +\n          s.slice(i + 3)\n      }\n    }\n  }\n  if (s.slice(-5) === '#this') s = s.slice(0, -5)\n  else if (s.slice(-3) === '#me') s = s.slice(0, -3)\n\n  var hash = s.indexOf('#')\n  if (hash >= 0) return cleanUp(s.slice(hash + 1))\n\n  if (s.slice(-9) === '/foaf.rdf') s = s.slice(0, -9)\n  else if (s.slice(-5) === '/foaf') s = s.slice(0, -5)\n\n  // Eh? Why not do this? e.g. dc:title needs it only trim URIs, not rdfs:labels\n  var slash = s.lastIndexOf('/', s.length - 2) // (len-2) excludes trailing slash\n  if (slash >= 0 && slash < x.uri.length) return cleanUp(s.slice(slash + 1))\n\n  return doCap(decodeURIComponent(x.uri))\n}\n\nfunction escapeForXML (str) {\n  return str.replace(/&/g, '&amp;').replace(/</g, '&lt;')\n}\n\n//  As above but escaped for XML and chopped of contains a slash\nfunction labelForXML (x) {\n  return escapeForXML(label(x))\n}\n\n// As above but for predicate, possibly inverse\nfunction predicateLabelForXML (p, inverse) {\n  var lab\n  if (inverse) {\n    // If we know an inverse predicate, use its label\n    var ip = UI.store.any(p, UI.ns.owl('inverseOf'))\n    if (!ip) ip = UI.store.any(undefined, UI.ns.owl('inverseOf'), p)\n    if (ip) return labelForXML(ip)\n  }\n\n  lab = labelForXML(p)\n  if (inverse) {\n    if (lab === 'type') return '...' // Not \"is type of\"\n    return 'is ' + lab + ' of'\n  }\n  return lab\n}\n\n// Not a method. For use in sorts\nfunction RDFComparePredicateObject (self, other) {\n  var x = self.predicate.compareTerm(other.predicate)\n  if (x !== 0) return x\n  return self.object.compareTerm(other.object)\n}\n\nfunction RDFComparePredicateSubject (self, other) {\n  var x = self.predicate.compareTerm(other.predicate)\n  if (x !== 0) return x\n  return self.subject.compareTerm(other.subject)\n}\n// ends\n\nfunction predParentOf (node) {\n  var n = node\n  while (true) {\n    if (n.getAttribute('predTR')) {\n      return n\n    } else if (n.previousSibling && n.previousSibling.nodeName === 'TR') {\n      n = n.previousSibling\n    } else {\n      UI.log.error('Could not find predParent')\n      return node\n    }\n  }\n}\n\n// makeQueryRow moved to outline mode\n"],"file":"utils.js"}