{"version":3,"file":"index.js","names":["_index","require","_solidLogic","_login","widgets","_interopRequireWildcard","style","_emptyProfile","_headerFooterHelpers","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","_typeof","has","get","set","_t3","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","DEFAULT_HELP_MENU_ICON","icons","iconBase","DEFAUL_SOLID_ICON_URL","initHeader","_x","_x2","_x3","_initHeader","apply","arguments","_asyncToGenerator2","_regenerator","mark","_callee2","store","userMenuList","options","header","pod","wrap","_context2","prev","next","document","getElementById","abrupt","getPod","rebuildHeader","authSession","onLogout","onLogin","stop","_callee","user","_t","_context","authn","currentUser","innerHTML","createBanner","appendChild","sent","_x4","_x5","_x6","_x7","_x8","_createBanner","_callee3","podLink","image","userMenu","banner","leftSideOfHeader","helpMenu","_t2","_context3","createElement","href","uri","setAttribute","headerBannerLink","src","logo","headerBannerIcon","createUserMenu","createLoginSignUpButtons","headerBanner","headerBannerRightMenu","helpMenuList","createHelpMenu","helpMenuItems","headerUserMenuList","forEach","menuItem","menuItemType","url","createUserMenuItem","createUserMenuLink","label","target","createUserMenuButton","onclick","headerUserMenuNavigationMenuNotDisplayed","helpMenuContainer","headerBannerUserMenu","helpMenuTrigger","headerUserMenuTrigger","type","helpMenuIcon","helpIcon","headerUserMenuTriggerImg","throttledMenuToggle","throttle","event","toggleMenu","addEventListener","timer","setTimeout","clearTimeout","nav","headerUserMenuNavigationMenu","profileLoginButtonPre","headerBannerLogin","loginStatusBox","onClick","button","headerUserMenuButton","onmouseover","headerUserMenuButtonHover","onmouseout","innerText","link","headerUserMenuLink","headerUserMenuLinkHover","_x9","_x0","_x1","_createUserMenu","_callee4","fetcher","loggedInMenuList","loggedInMenu","loggedInMenuTrigger","profileImg","loggedInMenuContainer","_context4","load","getProfileImg","headerBannerUserMenuNotDisplayed","child","menuProfileItem","headerUserMenuListItem","profileUrl","findImage","emptyProfile","_unused","profileImage","headerUserMenuPhoto","backgroundImage","concat","trigger","menu","isExpanded","getAttribute","expand","close","toString"],"sources":["../../src/header/index.ts"],"sourcesContent":["/* global EventListenerOrEventListenerObject */\n/*\n    This file was copied from mashlib/src/global/header.ts file. It is modified to\n    work in solid-ui by adjusting where imported functions are found.\n */\nimport { IndexedFormula, NamedNode } from 'rdflib'\nimport { icons } from '../index'\nimport { authn, authSession } from 'solid-logic'\nimport { loginStatusBox } from '../login/login'\n// import { loginStatusBox, authSession, currentUser } from '../authn/authn'\nimport * as widgets from '../widgets'\nimport * as style from '../style'\nimport { emptyProfile } from './empty-profile'\nimport { getPod, throttle } from '../utils/headerFooterHelpers'\n\n/**\n * menu icons\n*/\nconst DEFAULT_HELP_MENU_ICON = icons.iconBase + 'noun_help.svg'\nconst DEFAUL_SOLID_ICON_URL = 'https://solidproject.org/assets/img/solid-emblem.svg'\n\nexport type MenuItemLink = {\n  label: string,\n  url: string,\n  target?: string\n}\n\nexport type MenuItemButton = {\n  label: string,\n  onclick: () => void\n}\n\nexport type MenuItems = MenuItemLink | MenuItemButton\n\n/*\n  HeaderOptions allow for customizing the logo and menu list.  If a logo is not provided the default\n  is solid. Menulist will always show a link to logout and to the users profile.\n  */\nexport type HeaderOptions = {\n  logo?: string,\n  helpIcon?: string,\n  helpMenuList?: MenuItems[]\n}\n\n/**\n * Initialize header component, the header object returned depends on whether the user is authenticated.\n * @param store the data store\n * @param userMenuList a list of menu items when the user is logged in\n * @param options allow the header to be customized with a personalized logo, help icon and a help menu list of links or buttons.\n * @returns a header for an authenticated user with menu items given or a login screen\n */\nexport async function initHeader (store: IndexedFormula, userMenuList: MenuItems[], options?: HeaderOptions) {\n  const header = document.getElementById('PageHeader')\n  if (!header) {\n    return\n  }\n\n  const pod = getPod()\n  rebuildHeader(header, store, pod, userMenuList, options)()\n  authSession.onLogout(rebuildHeader(header, store, pod, userMenuList, options))\n  authSession.onLogin(rebuildHeader(header, store, pod, userMenuList, options))\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function rebuildHeader (header: HTMLElement, store: IndexedFormula, pod: NamedNode, userMenuList: MenuItems[], options?: HeaderOptions) {\n  return async () => {\n    const user = authn.currentUser()\n    header.innerHTML = ''\n    header.appendChild(await createBanner(store, pod, user, userMenuList, options))\n  }\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createBanner (store: IndexedFormula, pod: NamedNode, user: NamedNode | null, userMenuList: MenuItems[], options?: HeaderOptions): Promise<HTMLElement> {\n  const podLink = document.createElement('a')\n  podLink.href = pod.uri\n  podLink.setAttribute('style', style.headerBannerLink)\n  const image = document.createElement('img')\n  if (options) {\n    image.src = options.logo ? options.logo : DEFAUL_SOLID_ICON_URL\n  }\n  image.setAttribute('style', style.headerBannerIcon)\n  podLink.appendChild(image)\n\n  const userMenu = user\n    ? await createUserMenu(store, user, userMenuList)\n    : createLoginSignUpButtons()\n\n  const banner = document.createElement('div')\n  banner.setAttribute('style', style.headerBanner)\n  banner.appendChild(podLink)\n\n  const leftSideOfHeader = document.createElement('div')\n  leftSideOfHeader.setAttribute('style', style.headerBannerRightMenu)\n  leftSideOfHeader.appendChild(userMenu)\n\n  if (options && options.helpMenuList) {\n    const helpMenu = createHelpMenu(options, options.helpMenuList)\n    leftSideOfHeader.appendChild(helpMenu as HTMLDivElement)\n  }\n\n  banner.appendChild(leftSideOfHeader)\n\n  return banner\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createHelpMenu (options: HeaderOptions, helpMenuItems: MenuItems[]) {\n  if (!helpMenuItems) return\n  const helpMenuList = document.createElement('ul')\n  helpMenuList.setAttribute('style', style.headerUserMenuList)\n  helpMenuItems.forEach(function (menuItem) {\n    const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n    if (menuItemType === 'url') {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n    } else {\n      helpMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n    }\n  })\n\n  const helpMenu = document.createElement('nav')\n\n  helpMenu.setAttribute('style', style.headerUserMenuNavigationMenuNotDisplayed)\n  helpMenu.setAttribute('aria-hidden', 'true')\n  helpMenu.setAttribute('id', 'helperNav')\n  helpMenu.appendChild(helpMenuList)\n\n  const helpMenuContainer = document.createElement('div')\n  helpMenuContainer.setAttribute('style', style.headerBannerUserMenu)\n  helpMenuContainer.appendChild(helpMenu)\n\n  const helpMenuTrigger = document.createElement('button')\n  helpMenuTrigger.setAttribute('style', style.headerUserMenuTrigger)\n  helpMenuTrigger.type = 'button'\n\n  const helpMenuIcon = document.createElement('img')\n  helpMenuIcon.src = (options && options.helpIcon) ? options.helpIcon : icons.iconBase + DEFAULT_HELP_MENU_ICON\n  helpMenuIcon.setAttribute('style', style.headerUserMenuTriggerImg)\n  helpMenuContainer.appendChild(helpMenuTrigger)\n  helpMenuTrigger.appendChild(helpMenuIcon)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, helpMenuTrigger, helpMenu), 50)\n  helpMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  helpMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n    const nav = document.getElementById('helperNav')\n    nav?.setAttribute('style', style.headerUserMenuNavigationMenu)\n  })\n  helpMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n    const nav = document.getElementById('helperNav')\n    nav?.setAttribute('style', style.headerUserMenuNavigationMenuNotDisplayed)\n  })\n\n  return helpMenuContainer\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createLoginSignUpButtons () {\n  const profileLoginButtonPre = document.createElement('div')\n  profileLoginButtonPre.setAttribute('style', style.headerBannerLogin)\n  profileLoginButtonPre.appendChild(loginStatusBox(document, null, {}))\n  return profileLoginButtonPre\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuButton (label: string, onClick: EventListenerOrEventListenerObject): HTMLElement {\n  const button = document.createElement('button')\n  button.setAttribute('style', style.headerUserMenuButton)\n  button.onmouseover = function () {\n    button.setAttribute('style', style.headerUserMenuButtonHover)\n  }\n  button.onmouseout = function () {\n    button.setAttribute('style', style.headerUserMenuButton)\n  }\n  button.addEventListener('click', onClick)\n  button.innerText = label\n  return button\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuLink (label: string, href: string, target?: string): HTMLElement {\n  const link = document.createElement('a')\n  link.setAttribute('style', style.headerUserMenuLink)\n  link.onmouseover = function () {\n    link.setAttribute('style', style.headerUserMenuLinkHover)\n  }\n  link.onmouseout = function () {\n    link.setAttribute('style', style.headerUserMenuLink)\n  }\n  link.href = href\n  link.innerText = label\n  if (target) link.target = target\n  return link\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport async function createUserMenu (store: IndexedFormula, user: NamedNode, userMenuList: MenuItems[]): Promise<HTMLElement> {\n  const fetcher = (<any>store).fetcher\n  if (fetcher) {\n    // Making sure that Profile is loaded before building menu\n    await fetcher.load(user)\n  }\n\n  const loggedInMenuList = document.createElement('ul')\n  loggedInMenuList.setAttribute('style', style.headerUserMenuList)\n  if (userMenuList) {\n    userMenuList.forEach(function (menuItem) {\n      const menuItemType: string = (menuItem as MenuItemLink).url ? 'url' : 'onclick'\n      if (menuItemType === 'url') {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuLink(menuItem.label, (menuItem as MenuItemLink).url, (menuItem as MenuItemLink).target)))\n      } else {\n        loggedInMenuList.appendChild(createUserMenuItem(createUserMenuButton(menuItem.label, (menuItem as MenuItemButton).onclick)))\n      }\n    })\n  }\n  const loggedInMenu = document.createElement('nav')\n\n  loggedInMenu.setAttribute('style', style.headerUserMenuNavigationMenuNotDisplayed)\n  loggedInMenu.setAttribute('aria-hidden', 'true')\n  loggedInMenu.setAttribute('id', 'loggedInNav')\n  loggedInMenu.appendChild(loggedInMenuList)\n\n  const loggedInMenuTrigger = document.createElement('button')\n  loggedInMenuTrigger.setAttribute('style', style.headerUserMenuTrigger)\n  loggedInMenuTrigger.type = 'button'\n  const profileImg = getProfileImg(store, user)\n  if (typeof profileImg === 'string') {\n    loggedInMenuTrigger.innerHTML = profileImg\n  } else {\n    loggedInMenuTrigger.appendChild(profileImg)\n  }\n\n  const loggedInMenuContainer = document.createElement('div')\n  loggedInMenuContainer.setAttribute('style', style.headerBannerUserMenuNotDisplayed)\n  loggedInMenuContainer.appendChild(loggedInMenuTrigger)\n  loggedInMenuContainer.appendChild(loggedInMenu)\n\n  const throttledMenuToggle = throttle((event: Event) => toggleMenu(event, loggedInMenuTrigger, loggedInMenu), 50)\n  loggedInMenuTrigger.addEventListener('click', throttledMenuToggle)\n  let timer = setTimeout(() => null, 0)\n  loggedInMenuContainer.addEventListener('mouseover', event => {\n    clearTimeout(timer)\n    throttledMenuToggle(event)\n    const nav = document.getElementById('loggedInNav')\n    nav?.setAttribute('style', style.headerUserMenuNavigationMenu)\n  })\n  loggedInMenuContainer.addEventListener('mouseout', event => {\n    timer = setTimeout(() => throttledMenuToggle(event), 200)\n    const nav = document.getElementById('loggedInNav')\n    nav?.setAttribute('style', style.headerUserMenuNavigationMenuNotDisplayed)\n  })\n\n  return loggedInMenuContainer\n}\n\n/**\n * @ignore exporting this only for the unit test\n */\nexport function createUserMenuItem (child: HTMLElement): HTMLElement {\n  const menuProfileItem = document.createElement('li')\n  menuProfileItem.setAttribute('style', style.headerUserMenuListItem)\n  menuProfileItem.appendChild(child)\n  return menuProfileItem\n}\n/**\n * @ignore exporting this only for the unit test\n */\nexport function getProfileImg (store: IndexedFormula, user: NamedNode): string | HTMLElement {\n  let profileUrl = null\n  try {\n    profileUrl = widgets.findImage(user)\n    if (!profileUrl) {\n      return emptyProfile\n    }\n  } catch {\n    return emptyProfile\n  }\n\n  const profileImage = document.createElement('div')\n  profileImage.setAttribute('style', style.headerUserMenuPhoto)\n  profileImage.style.backgroundImage = `url(${profileUrl})`\n  return profileImage\n}\n\n/**\n * @internal\n */\nfunction toggleMenu (event: Event, trigger: HTMLButtonElement, menu: HTMLElement): void {\n  const isExpanded = trigger.getAttribute('aria-expanded') === 'true'\n  const expand = event.type === 'mouseover'\n  const close = event.type === 'mouseout'\n  if ((isExpanded && expand) || (!isExpanded && close)) {\n    return\n  }\n  trigger.setAttribute('aria-expanded', (!isExpanded).toString())\n  menu.setAttribute('aria-hidden', isExpanded.toString())\n}\n"],"mappings":"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","ignoreList":[]}