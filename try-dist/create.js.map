{"version":3,"sources":["../src/create.js"],"names":["UI","authn","require","icons","log","ns","store","style","utils","widgets","kb","module","exports","newThingUI","createContext","dataBrowserContext","thePanes","Error","dom","div","me","uri","iconStyle","star","appendChild","createElement","visible","setAttribute","iconBase","complain","message","pre","createTextNode","styleTheIcons","i","iconArray","length","st","disabled","selectTool","icon","selectNewTool","_event","addEventListener","makeNewAppInstance","options","Promise","resolve","reject","selectUI","callbackWS","ws","newBase","logInLoadProfile","then","_context","newPaneOptions","workspace","opt","console","pane","name","mintNew","newInstance","folder","tail","slice","isPackage","includes","add","ldp","sym","doc","refreshTarget","refresh","p","innerHTML","noun","err","pa","appPathSegment","mintClass","label","selectWorkspace","gotName","endsWith","encodeURIComponent","askName","foaf","mintingPanes","Object","values","filter","mintingClassMap","reduce","classMap","forEach","push","e","event","iconEle","noIndexHTML"],"mappings":"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","sourcesContent":["/*   create.js     UI to craete new objects in the solid-app-set world\r\n **\r\n */\r\n// const error = require('./widgets/error')\r\n// const widgets = require('./widgets/index')\r\n// const utils = require('./utils')\r\n\r\n// const UI = require('solid-ui')\r\n\r\nconst UI = {\r\n  authn: require('./authn/authn'),\r\n  icons: require('./iconBase'),\r\n  log: require('./log'),\r\n  ns: require('./ns'),\r\n  store: require('./store'),\r\n  style: require('./style'),\r\n  utils: require('./utils'),\r\n  widgets: require('./widgets')\r\n}\r\n\r\nconst kb = UI.store\r\n\r\nmodule.exports = {\r\n  newThingUI\r\n}\r\n\r\n/*  newThingUI -- return UI for user to select a new object, folder, etc\r\n **\r\n ** context must include:  dom, div,\r\n **     optional:   folder: NamedNode -- the folder where the thing is bring put\r\n **                (suppresses asking for a full URI or workspace)\r\n **\r\n */\r\nfunction newThingUI (createContext, dataBrowserContext, thePanes) {\r\n  if (!thePanes) throw new Error('@@ newThingUI: update API') // phase out\r\n  const dom = createContext.dom\r\n  const div = createContext.div\r\n  if (createContext.me && !createContext.me.uri) {\r\n    throw new Error('newThingUI:  Invalid userid: ' + createContext.me)\r\n  }\r\n\r\n  const iconStyle = 'padding: 0.7em; width: 2em; height: 2em;' // was: 'padding: 1em; width: 3em; height: 3em;'\r\n  const star = div.appendChild(dom.createElement('img'))\r\n  var visible = false // the inividual tools tools\r\n  //   noun_272948.svg = black star\r\n  // noun_34653_green.svg = green plus\r\n  star.setAttribute('src', UI.icons.iconBase + 'noun_34653_green.svg')\r\n  star.setAttribute('style', iconStyle)\r\n  star.setAttribute('title', 'Add another tool')\r\n\r\n  var complain = function complain (message) {\r\n    var pre = div.appendChild(dom.createElement('pre'))\r\n    pre.setAttribute('style', 'background-color: pink')\r\n    pre.appendChild(dom.createTextNode(message))\r\n  }\r\n\r\n  function styleTheIcons (style) {\r\n    for (var i = 0; i < iconArray.length; i++) {\r\n      var st = iconStyle + style\r\n      if (iconArray[i].disabled) {\r\n        // @@ unused\r\n        st += 'opacity: 0.3;'\r\n      }\r\n      iconArray[i].setAttribute('style', st) // eg 'background-color: #ccc;'\r\n    }\r\n  }\r\n\r\n  function selectTool (icon) {\r\n    styleTheIcons('display: none;') // 'background-color: #ccc;'\r\n    icon.setAttribute('style', iconStyle + 'background-color: yellow;')\r\n  }\r\n\r\n  function selectNewTool (_event) {\r\n    visible = !visible\r\n    star.setAttribute(\r\n      'style',\r\n      iconStyle + (visible ? 'background-color: yellow;' : '')\r\n    )\r\n    styleTheIcons(visible ? '' : 'display: none;')\r\n  }\r\n\r\n  star.addEventListener('click', selectNewTool)\r\n\r\n  function makeNewAppInstance (options) {\r\n    return new Promise(function (resolve, reject) {\r\n      var selectUI // , selectUIParent\r\n      function callbackWS (ws, newBase) {\r\n        UI.authn.logInLoadProfile(createContext).then(\r\n          _context => {\r\n            var newPaneOptions = {\r\n              newBase: newBase,\r\n              workspace: ws\r\n            }\r\n            for (var opt in options) {\r\n              // get div, dom, me, folder, pane, refreshTable\r\n              newPaneOptions[opt] = options[opt]\r\n            }\r\n            console.log(\r\n              'newThingUI: Minting new ' +\r\n                newPaneOptions.pane.name +\r\n                ' at ' +\r\n                newPaneOptions.newBase\r\n            )\r\n            options.pane\r\n              .mintNew(dataBrowserContext, newPaneOptions)\r\n              .then(function (newPaneOptions) {\r\n                if (!newPaneOptions || !newPaneOptions.newInstance) {\r\n                  throw new Error('Cannot mint new - missing newInstance')\r\n                }\r\n                if (newPaneOptions.folder) {\r\n                  var tail = newPaneOptions.newInstance.uri.slice(\r\n                    newPaneOptions.folder.uri.length\r\n                  )\r\n                  const isPackage = tail.includes('/')\r\n                  console.log('  new thing is packge? ' + isPackage)\r\n                  if (isPackage) {\r\n                    kb.add(\r\n                      newPaneOptions.folder,\r\n                      UI.ns.ldp('contains'),\r\n                      kb.sym(newPaneOptions.newBase),\r\n                      newPaneOptions.folder.doc()\r\n                    )\r\n                  } else {\r\n                    // single file\r\n                    kb.add(\r\n                      newPaneOptions.folder,\r\n                      UI.ns.ldp('contains'),\r\n                      newPaneOptions.newInstance,\r\n                      newPaneOptions.folder.doc()\r\n                    ) // Ping the patch system?\r\n                  }\r\n                  if (newPaneOptions.refreshTarget) {\r\n                    newPaneOptions.refreshTarget.refresh() // Refresh the cntaining display\r\n                  }\r\n                  // selectUI.parentNode.removeChild(selectUI) It removes itself\r\n                } else {\r\n                  var p = options.div.appendChild(dom.createElement('p'))\r\n                  p.setAttribute('style', 'font-size: 120%;')\r\n                  // Make link to new thing\r\n                  p.innerHTML =\r\n                    \"Your <a target='_blank' href='\" +\r\n                    newPaneOptions.newInstance.uri +\r\n                    \"'><b>new \" +\r\n                    options.noun +\r\n                    '</b></a> is ready to be set up. ' +\r\n                    \"<br/><br/><a target='_blank' href='\" +\r\n                    newPaneOptions.newInstance.uri +\r\n                    \"'>Go to your new \" +\r\n                    options.noun +\r\n                    '.</a>'\r\n                  // selectUI.parentNode.removeChild(selectUI) // Clean up\r\n                  // selectUIParent.removeChild(selectUI) // Clean up\r\n                }\r\n                selectNewTool() // toggle star to plain and menu vanish again\r\n              })\r\n              .catch(function (err) {\r\n                complain(err)\r\n                reject(err)\r\n              })\r\n          },\r\n          err => {\r\n            // login fails\r\n            complain('Error logging on: ' + err)\r\n          }\r\n        )\r\n      } // callbackWS\r\n\r\n      var pa = options.pane\r\n      options.appPathSegment = 'edu.mit.solid.pane.' + pa.name\r\n      options.noun = pa.mintClass ? UI.utils.label(pa.mintClass) : pa.name\r\n\r\n      if (!options.folder) {\r\n        // No folder given? Ask user for full URI\r\n        selectUI = UI.authn.selectWorkspace(dom, options, callbackWS)\r\n        options.div.appendChild(selectUI)\r\n        // selectUIParent = options.div\r\n      } else {\r\n        var gotName = function (name) {\r\n          if (!name) {\r\n            // selectUIParent.removeChild(selectUI)   itremves itself if cancelled\r\n            selectNewTool() // toggle star to plain and menu vanish again\r\n          } else {\r\n            var uri = options.folder.uri\r\n            if (!uri.endsWith('/')) {\r\n              uri = uri + '/'\r\n            }\r\n            uri = uri + encodeURIComponent(name) + '/'\r\n            callbackWS(null, uri)\r\n          }\r\n        }\r\n        UI.widgets\r\n          .askName(\r\n            dom,\r\n            UI.store,\r\n            options.div,\r\n            UI.ns.foaf('name'),\r\n            null,\r\n            options.noun\r\n          )\r\n          .then(gotName)\r\n        // selectUI = getNameForm(dom, UI.store, options.noun, gotName)\r\n        // options.div.appendChild(selectUI)\r\n        // selectUIParent = options.div\r\n      }\r\n    })\r\n  } // makeNewAppInstance\r\n\r\n  const iconArray = []\r\n  const mintingPanes = Object.values(thePanes).filter(pane => pane.mintNew)\r\n  const mintingClassMap = mintingPanes.reduce((classMap, pane) => {\r\n    if (pane.mintClass) {\r\n      classMap[pane.mintClass] = (classMap[pane.mintClass] || 0) + 1\r\n    }\r\n    return classMap\r\n  }, {})\r\n  mintingPanes.forEach(pane => {\r\n    const icon = createContext.div.appendChild(dom.createElement('img'))\r\n    icon.setAttribute('src', pane.icon)\r\n    const noun = pane.mintClass\r\n      ? mintingClassMap[pane.mintClass] > 1\r\n        ? `${UI.utils.label(pane.mintClass)} (using ${pane.name} pane)`\r\n        : UI.utils.label(pane.mintClass)\r\n      : pane.name + ' @@'\r\n    icon.setAttribute('title', 'Make new ' + noun)\r\n    icon.setAttribute('style', iconStyle + 'display: none;')\r\n    iconArray.push(icon)\r\n    if (!icon.disabled) {\r\n      icon.addEventListener('click', function (e) {\r\n        selectTool(icon)\r\n        makeNewAppInstance({\r\n          event: e,\r\n          folder: createContext.folder,\r\n          iconEle: icon,\r\n          pane,\r\n          noun,\r\n          noIndexHTML: true, // do NOT @@ for now write a HTML file\r\n          div: createContext.div,\r\n          me: createContext.me,\r\n          dom: createContext.dom,\r\n          refreshTarget: createContext.refreshTarget\r\n        })\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n// Form to get the name of a new thing before we create it\r\n//\r\n// Used in contacts for new groups, individuals.\r\n//\r\n/*\r\nfunction getNameForm (dom, kb, classLabel, gotNameCallback) {\r\n  var form = dom.createElement('div') // form is broken as HTML behaviour can resurface on js error\r\n  form.innerHTML = '<p>Name of new ' + classLabel + ':</p>'\r\n  var namefield = dom.createElement('input')\r\n  namefield.setAttribute('type', 'text')\r\n  namefield.setAttribute('size', '30')\r\n  namefield.setAttribute('style', UI.style.textInputStyle)\r\n  namefield.setAttribute('maxLength', '2048') // No arbitrary limits\r\n  namefield.select() // focus next user input\r\n\r\n  var gotName = function () {\r\n    namefield.setAttribute('class', 'pendingedit')\r\n    namefield.disabled = true\r\n    continueButton.disabled = true\r\n    cancel.disabled = true\r\n    gotNameCallback(true, namefield.value)\r\n  }\r\n\r\n  namefield.addEventListener('keyup', function (e) {\r\n    if (e.keyCode === 13) {\r\n      gotName()\r\n    }\r\n  }, false)\r\n  form.appendChild(namefield)\r\n\r\n  form.appendChild(dom.createElement('br'))\r\n\r\n  var cancel = form.appendChild(UI.widgets.cancelButton(dom))\r\n  cancel.addEventListener('click', function (e) {\r\n    form.parentNode.removeChild(form)\r\n    gotNameCallback(false)\r\n  }, false)\r\n\r\n  var continueButton = form.appendChild(UI.widgets.continueButton(dom))\r\n  continueButton.addEventListener('click', function (e) {\r\n    gotName()\r\n  }, false)\r\n\r\n  return form\r\n}\r\n*/\r\n"],"file":"create.js"}