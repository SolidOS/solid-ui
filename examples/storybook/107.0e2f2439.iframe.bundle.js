"use strict";(self.webpackChunksolid_ui=self.webpackChunksolid_ui||[]).push([[107],{"./src/iconBase.ts":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Pt:()=>icons,i1:()=>originalIconBase});var _debug__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/debug.ts");const icons=(module=__webpack_require__.hmd(module)).scriptURI?{iconBase:module.scriptURI.slice(0,module.scriptURI.lastIndexOf("/"))+"/icons/",originalIconBase:module.scriptURI.slice(0,module.scriptURI.lastIndexOf("/"))+"/originalIcons/"}:"undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.iconBase?{iconBase:$SolidTestEnvironment.iconBase,originalIconBase:$SolidTestEnvironment.originalIconBase}:{iconBase:"https://solidos.github.io/solid-ui/src/icons/",originalIconBase:"https://solidos.github.io/solid-ui/src/originalIcons/"};(0,_debug__WEBPACK_IMPORTED_MODULE_0__.Rm)("   icons.iconBase is set to : "+icons.iconBase);icons.iconBase;const originalIconBase=icons.originalIconBase},"./src/log.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{LogLevel:()=>LogLevel,alert:()=>alert,clear:()=>clear,debug:()=>debug,dumpHTML:()=>dumpHTML,error:()=>error,escapeForXML:()=>escapeForXML,info:()=>info,logAscending:()=>logAscending,logDescending:()=>logDescending,msg:()=>msg,setInternals:()=>setInternals,setLevel:()=>setLevel,success:()=>success,warn:()=>warn});const TERROR=1,TWARN=2,TMESG=4,TSUCCESS=8,TINFO=16,TDEBUG=32,TALL=63;let LogLevel=function(LogLevel){return LogLevel[LogLevel.Error=1]="Error",LogLevel[LogLevel.Warning=2]="Warning",LogLevel[LogLevel.Message=4]="Message",LogLevel[LogLevel.Success=8]="Success",LogLevel[LogLevel.Info=16]="Info",LogLevel[LogLevel.Debug=32]="Debug",LogLevel[LogLevel.All=63]="All",LogLevel}({}),_level=TERROR+TWARN+TMESG,_ascending=!1,_dom=document,_window=window;function log(str,type=TMESG,typestr="mesg"){if(_level&type)if(void 0!==_dom){const logArea=_dom.getElementById("status");if(!logArea)return;const addendum=_dom.createElement("span");addendum.setAttribute("class",typestr);const now=new Date;addendum.innerHTML=`${now.getHours()}:${now.getMinutes()}:${now.getSeconds()} [${typestr}] ${escapeForXML(str)}<br/>`,_ascending?logArea.insertBefore(addendum,logArea.firstChild):logArea.appendChild(addendum)}else"undefined"!=typeof console&&console.log(str)}function msg(message){log(message)}function warn(message){log(message,TWARN,"warn")}function debug(message){log(message,TDEBUG,"dbug")}function info(message){log(message,TINFO,"info")}function error(message){log(message,TERROR,"eror")}function success(message){log(message,TSUCCESS,"good")}function alert(message){_window&&void 0!==_window.alert?_window.alert(message):warn(message)}function clear(){const logArea=_dom?.getElementById("status");logArea&&(logArea.innerHTML="")}function setLevel(level){_level=TALL,debug("Log level is now "+level),_level=level}function dumpHTML(){if(!_dom)return;const level=_level;_level=TALL,debug(_dom?.body?.innerHTML||""),_level=level}function logAscending(){_ascending=!0}function logDescending(){_ascending=!1}function escapeForXML(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function setInternals(window,document){_window=window,_dom=document}},"./src/ns.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var solid_namespace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/solid-namespace/index.js"),solid_namespace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(solid_namespace__WEBPACK_IMPORTED_MODULE_0__),rdflib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rdflib/esm/index.js");const __WEBPACK_DEFAULT_EXPORT__=solid_namespace__WEBPACK_IMPORTED_MODULE_0___default()(rdflib__WEBPACK_IMPORTED_MODULE_1__)},"./src/utils/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AW:()=>escapeForXML,EW:()=>getTarget,Of:()=>syncTableToArrayReOrdered,SY:()=>labelWithOntology,Tp:()=>beep,c5:()=>syncTableToArray});var _log__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/log.ts"),solid_logic__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/solid-logic/dist/solid-logic.esm.js"),_ns__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/ns.js"),rdflib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rdflib/esm/index.js"),_label__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/label.ts");const UI={log:_log__WEBPACK_IMPORTED_MODULE_0__,ns:_ns__WEBPACK_IMPORTED_MODULE_2__.A,rdf:rdflib__WEBPACK_IMPORTED_MODULE_3__};let audioContext;function beep(){if(!audioContext)return;const ctx=new audioContext;return function(duration,frequency,type,finishedCallback){duration=+(duration||.3),type=type||"sine","function"!=typeof finishedCallback&&(finishedCallback=function(){});const osc=ctx.createOscillator();osc.type=type,osc.frequency.value=frequency||256,osc.connect(ctx.destination),osc.start(0),osc.stop(duration)}}function syncTableToArray(table,things,createNewRow){let foundOne,row,i;for(i=0;i<table.children.length;i++)row=table.children[i],row.trashMe=!0;for(let g=0;g<things.length;g++){const thing=things[g];for(foundOne=!1,i=0;i<table.children.length;i++)if(row=table.children[i],row.subject&&row.subject.sameTerm(thing)){row.trashMe=!1,foundOne=!0;break}if(!foundOne){const newRow=createNewRow(thing);if(g>=table.children.length)table.appendChild(newRow);else{const ele=table.children[g];table.insertBefore(newRow,ele)}newRow.subject=thing}}for(i=0;i<table.children.length;i++)row=table.children[i],row.trashMe&&table.removeChild(row)}function syncTableToArrayReOrdered(table,things,createNewRow){const elementMap={};for(let i=0;i<table.children.length;i++){const row=table.children[i];elementMap[row.subject.toNT()]=row}for(let g=0;g<things.length;g++){const thing=things[g];if(g>=table.children.length){const newRow=createNewRow(thing);newRow.subject=thing,table.appendChild(newRow)}else{const row=table.children[g];if(row.subject.sameTerm(thing));else{const existingRow=elementMap[thing.toNT()];if(existingRow)table.removeChild(existingRow),table.insertBefore(existingRow,row);else{const newRow=createNewRow(thing);row.before(newRow),newRow.subject=thing}}}}for(;table.children.length>things.length;)table.removeChild(table.children[table.children.length-1])}function getTarget(e){let target;return(e=e||window.event).target?target=e.target:e.srcElement&&(target=e.srcElement),3===target.nodeType&&(target=target.parentNode),target}function labelWithOntology(x,initialCap){const t=solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.findTypeURIs(x);return t[UI.ns.rdf("Predicate").uri]||t[UI.ns.rdfs("Class").uri]?(0,_label__WEBPACK_IMPORTED_MODULE_4__.P)(x,initialCap)+" ("+function ontologyLabel(term){if(void 0===term.uri)return"??";let s=term.uri;const namespaces=[];let part,i=s.lastIndexOf("#");if(i>=0)s=s.slice(0,i+1);else{if(i=s.lastIndexOf("/"),!(i>=0))return term.uri+"?!";s=s.slice(0,i+1)}for(const ns in UI.ns)namespaces[UI.ns[ns]]=ns;try{return namespaces[s]}catch(e){}for(s=s.slice(0,-1);s;){if(i=s.lastIndexOf("/"),!(i>=0))return term.uri+"!?";if(part=s.slice(i+1),s=s.slice(0,i),"ns"!==part&&"0123456789".indexOf(part[0])<0)return part}}(x)+")":(0,_label__WEBPACK_IMPORTED_MODULE_4__.P)(x,initialCap)}function escapeForXML(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;")}"undefined"!=typeof AudioContext?audioContext=AudioContext:"undefined"!=typeof window&&(audioContext=window.AudioContext||window.webkitAudioContext)},"./src/utils/label.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>label});var _log__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/log.ts"),solid_logic__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/solid-logic/dist/solid-logic.esm.js"),_ns__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/ns.js"),rdflib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rdflib/esm/index.js");const UI={log:_log__WEBPACK_IMPORTED_MODULE_0__,ns:_ns__WEBPACK_IMPORTED_MODULE_2__.A,rdf:rdflib__WEBPACK_IMPORTED_MODULE_3__};function label(thing,initialCap=!1){function doCap(label){return initialCap?label.slice(0,1).toUpperCase()+label.slice(1):label}function cleanUp(label){let result="";"/"===label.slice(-1)&&(label=label.slice(0,-1));for(let i=0;i<label.length;i++)"_"!==label[i]&&"-"!==label[i]?(result+=label[i],i+1<label.length&&label[i].toUpperCase()!==label[i]&&label[i+1].toLowerCase()!==label[i+1]&&(result+=" ")):result+=" ";return"has "===result.slice(0,4)&&(result=result.slice(4)),doCap(result)}const label=function getWellKnownLabel(thing){return solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.ui("label"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.link("message"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.vcard("fn"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.foaf("name"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.dct("title"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.dc("title"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.rss("title"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.contact("fullName"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.sym("http://www.w3.org/2001/04/roadmap/org#name"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.cal("summary"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.foaf("nick"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.as("name"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.schema("name"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,UI.ns.rdfs("label"))||solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.any(thing,solid_logic__WEBPACK_IMPORTED_MODULE_1__.store.sym("http://www.w3.org/2004/02/skos/core#prefLabel"))}(thing);if(label)return doCap(label.value);if("BlankNode"===thing.termType)return"...";if("Collection"===thing.termType)return"("+thing.elements.length+")";let s=thing.uri;if(void 0===s)return thing.toString();try{s=s.split("/").map(decodeURIComponent).join("/")}catch(_e){for(let i=s.length-3;i>0;i--){const hex="0123456789abcefABCDEF";for(;"%"===s[i]&&hex.indexOf(s[i+1])>=0&&hex.indexOf(s[i+2])>=0;)s=s.slice(0,i)+String.fromCharCode(parseInt(s.slice(i+1,i+3),16))+s.slice(i+3)}}s=slice(s,"/profile/card#me"),s=slice(s,"#this"),s=slice(s,"#me");const hash=s.indexOf("#");if(hash>=0)return cleanUp(s.slice(hash+1));const slash=s.lastIndexOf("/",s.length-2);return slash>=0&&slash<thing.uri.length?cleanUp(s.slice(slash+1)):doCap(decodeURIComponent(thing.uri))}function slice(s,suffix){const length=-1*suffix.length;return s.slice(length)===suffix?s.slice(0,length):s}},"./src/widgets/buttons.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CS:()=>addStyleSheet,Pg:()=>allClassURIs,RG:()=>askName,sf:()=>attachmentList,x6:()=>buttons_button,x7:()=>cancelButton,EW:()=>clearElement,cc:()=>complain,kz:()=>continueButton,Qf:()=>defaultAnnotationStore,Qy:()=>deleteButtonWithCheck,er:()=>extractLogURI,fT:()=>fileUploadButtonDiv,F1:()=>findImage,ZT:()=>findImageFromURI,r6:()=>formatDateTime,p_:()=>iconForClass,IC:()=>imagesOf,Pe:()=>index,JK:()=>isAudio,wu:()=>isImage,cZ:()=>isVideo,$J:()=>linkButton,ol:()=>openHrefInOutlineMode,Cl:()=>personTR,uA:()=>propertyTriage,uS:()=>refreshTree,DT:()=>removeButton,Ss:()=>renderAsDiv,Ag:()=>selectorPanel,RS:()=>selectorPanelRefresh,g7:()=>setImage,i:()=>setName,XV:()=>shortDate,Mj:()=>shortTime,vE:()=>timestamp});var uri=__webpack_require__("./node_modules/rdflib/esm/uri.js"),esm=__webpack_require__("./node_modules/rdflib/esm/index.js"),utils_js=__webpack_require__("./node_modules/rdflib/esm/utils-js.js"),iconBase=__webpack_require__("./src/iconBase.ts"),ns=__webpack_require__("./src/ns.js"),style=__webpack_require__("./src/style.js"),debug=__webpack_require__("./src/debug.ts"),log=__webpack_require__("./src/log.ts"),dragAndDrop=__webpack_require__("./src/widgets/dragAndDrop.js"),solid_logic_esm=__webpack_require__("./node_modules/solid-logic/dist/solid-logic.esm.js"),label=__webpack_require__("./src/utils/label.ts"),utils=__webpack_require__("./src/utils/index.js"),error=__webpack_require__("./src/widgets/error.ts");const wrapDivInATR=(dom,div,obj)=>{const tr=dom.createElement("tr");return tr.appendChild(dom.createElement("td")).appendChild(div),tr.subject=obj,tr},addClickListenerToElement=(div,onClickFunction)=>{div.addEventListener("click",onClickFunction)},createImageDiv=(dom,div,image)=>{const imageDiv=div.appendChild(dom.createElement("div"));imageDiv.setAttribute("style",style.i.imageDivStyle),imageDiv.appendChild(image),image.setAttribute("draggable","false")};var iconLinks=__webpack_require__("./src/widgets/buttons/iconLinks.ts");const{iconBase:buttons_iconBase}=iconBase.Pt,cancelIconURI=buttons_iconBase+"noun_1180156.svg",checkIconURI=buttons_iconBase+"noun_1180158.svg";function complain(context,err){if(!err)return;const ele=function getStatusArea(context){let box=context&&context.statusArea||context&&context.div||null;if(box)return box;let dom=context&&context.dom;if(dom||"undefined"==typeof document||(dom=document),dom){const body=dom.getElementsByTagName("body")[0];return box=dom.createElement("div"),body.insertBefore(box,body.firstElementChild),context&&(context.statusArea=box),box}return null}(context);debug.Rm("Complaint: "+err),ele?ele.appendChild((0,error.F)(context&&context.dom||document,err)):alert(err)}function clearElement(ele){for(;ele.firstChild;)ele.removeChild(ele.firstChild);return ele}function extractLogURI(fullURI){const logPos=fullURI.search(/logFile=/),rulPos=fullURI.search(/&rulesFile=/);return fullURI.substring(logPos+8,rulPos)}function shortDate(str,noTime){if(!str)return"???";const month=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];try{const nowZ=(new Date).toISOString();return str.slice(0,10)!==nowZ.slice(0,10)||noTime?str.slice(0,4)===nowZ.slice(0,4)?month[parseInt(str.slice(5,7),10)-1]+" "+parseInt(str.slice(8,10),10):str.slice(0,10):str.slice(11,16)}catch(e){return"shortdate:"+e}}function formatDateTime(date,format){return format.split("{").map(function(s){const k=s.split("}")[0];return s?("000"+(date["get"+k]()+({Month:1}[k]||0))).slice(-({Milliseconds:3,FullYear:4}[k]||2))+s.split("}")[1]:""}).join("")}function timestamp(){return formatDateTime(new Date,"{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}.{Milliseconds}")}function shortTime(){return formatDateTime(new Date,"{Hours}:{Minutes}:{Seconds}.{Milliseconds}")}function setName(element,x){const kb=solid_logic_esm.store,findName=function(x){const name=kb.any(x,ns.A.vcard("fn"))||kb.any(x,ns.A.foaf("name"))||kb.any(x,ns.A.vcard("organization-name"));return name?name.value:null},name=x.sameTerm(ns.A.foaf("Agent"))?"Everyone":findName(x);if(element.textContent=name||label.P(x),!name&&x.uri){if(!kb.fetcher)throw new Error("kb has no fetcher");kb.fetcher.nowOrWhenFetched(x.doc(),void 0,function(_ok){element.textContent=findName(x)||label.P(x)})}}function imagesOf(x,kb){return kb.each(x,ns.A.sioc("avatar")).concat(kb.each(x,ns.A.foaf("img"))).concat(kb.each(x,ns.A.vcard("logo"))).concat(kb.each(x,ns.A.vcard("hasPhoto"))).concat(kb.each(x,ns.A.vcard("photo"))).concat(kb.each(x,ns.A.foaf("depiction")))}const iconForClass={"solid:AppProviderClass":"noun_144.svg","solid:AppProvider":"noun_15177.svg","solid:Pod":"noun_Cabinet_1434380.svg","vcard:Group":"noun_339237.svg","vcard:Organization":"noun_143899.svg","vcard:Individual":"noun_15059.svg","schema:Person":"noun_15059.svg","foaf:Person":"noun_15059.svg","foaf:Agent":"noun_98053.svg","acl:AuthenticatedAgent":"noun_99101.svg","prov:SoftwareAgent":"noun_Robot_849764.svg","vcard:AddressBook":"noun_15695.svg","trip:Trip":"noun_581629.svg","meeting:LongChat":"noun_1689339.svg","meeting:Meeting":"noun_66617.svg","meeting:Project":"noun_1036577.svg","ui:Form":"noun_122196.svg","rdfs:Class":"class-rectangle.svg","rdf:Property":"property-diamond.svg","owl:Ontology":"noun_classification_1479198.svg","wf:Tracker":"noun_122196.svg","wf:Task":"noun_17020_gray-tick.svg","wf:Open":"noun_17020_sans-tick.svg","wf:Closed":"noun_17020.svg"};function tempSite(x){const str=x.uri.split("#")[0],p=str.indexOf("//");if(p<0)throw new Error("This URI does not have a web site part (origin)");const q=str.indexOf("/",p+2);return q<0?str.slice(0)+"/":str.slice(0,q+1)}function findImageFromURI(x){const iconDir=buttons_iconBase;return"string"!=typeof x&&x.uri?4!==x.uri.split("/").length||x.uri.split("/")[1]||x.uri.split("/")[3]?x.uri.startsWith("message:")||x.uri.startsWith("mid:")?iconDir+"noun_480183.svg":x.uri.startsWith("mailto:")?iconDir+"noun_567486.svg":x.uri.startsWith("https:")&&x.uri.indexOf("#")<0?tempSite(x)+"favicon.ico":null:iconDir+"noun_15177.svg":iconDir+"noun_10636_grey.svg"}function findImage(thing){const kb=solid_logic_esm.store,iconDir=buttons_iconBase;if(thing.sameTerm(ns.A.foaf("Agent"))||thing.sameTerm(ns.A.rdf("Resource")))return iconDir+"noun_98053.svg";const image=kb.any(thing,ns.A.sioc("avatar"))||kb.any(thing,ns.A.foaf("img"))||kb.any(thing,ns.A.vcard("logo"))||kb.any(thing,ns.A.vcard("hasPhoto"))||kb.any(thing,ns.A.vcard("photo"))||kb.any(thing,ns.A.foaf("depiction"));return image?image.uri:null}function trySetImage(element,thing,iconForClassMap){const kb=solid_logic_esm.store,explitImage=findImage(thing);if(explitImage)return element.setAttribute("src",explitImage),!0;const typeIcon=iconForClassMap[thing.uri];if(typeIcon)return element.setAttribute("src",typeIcon),element.style=style.i.classIconStyle,!0;const schemeIcon=findImageFromURI(thing);if(schemeIcon)return element.setAttribute("src",schemeIcon),!0;const types=kb.findTypeURIs(thing);for(const typeURI in types)if(iconForClassMap[typeURI])return element.setAttribute("src",iconForClassMap[typeURI]),!1;return element.setAttribute("src",buttons_iconBase+"noun_10636_grey.svg"),!1}function setImage(element,thing){const kb=solid_logic_esm.store,iconForClassMap={};for(const k in iconForClass){const pref=k.split(":")[0],id=k.split(":")[1],theClass=ns.A[pref](id);iconForClassMap[theClass.uri]=uri.join(iconForClass[k],buttons_iconBase)}if(!trySetImage(element,thing,iconForClassMap)&&thing.uri){if(!kb.fetcher)throw new Error("kb has no fetcher");kb.fetcher.nowOrWhenFetched(thing.doc(),void 0,ok=>{ok&&trySetImage(element,thing,iconForClassMap)})}}function faviconOrDefault(dom,x){const image=dom.createElement("img");image.style=style.i.iconStyle;if(image.setAttribute("src",buttons_iconBase+(function(x){if(!x.uri)return!1;const parts=x.uri.split("/");return 3===parts.length||4===parts.length&&""===parts[3]}(x)?"noun_15177.svg":"noun_681601.svg")),x.uri&&x.uri.startsWith("https:")&&x.uri.indexOf("#")<0){const res=dom.createElement("object");return res.setAttribute("data",tempSite(x)+"favicon.ico"),res.setAttribute("type","image/x-icon"),res.appendChild(image),res}return setImage(image,x),image}function deleteButtonWithCheck(dom,container,noun,deleteFunction){const minusIconURI=buttons_iconBase+"noun_2188_red.svg",deleteButton=dom.createElement("img");deleteButton.setAttribute("src",minusIconURI),deleteButton.setAttribute("style",style.i.smallButtonStyle),deleteButton.style.float="right";const prompt="Remove this "+noun;return deleteButton.title=prompt,deleteButton.classList.add("hoverControlHide"),deleteButton.addEventListener("click",function createPopup(){const refererenceElement=dom.createElement("div");container.insertBefore(refererenceElement,deleteButton),refererenceElement.style.position="relative",refererenceElement.appendChild(function renderDeleteConfirmPopup(dom,refererenceElement,prompt,deleteFunction){function removePopup(){refererenceElement.parentElement.removeChild(refererenceElement)}function removePopupAndDoDeletion(){removePopup(),deleteFunction()}const popup=dom.createElement("div");popup.style=style.i.confirmPopupStyle,popup.style.position="absolute",popup.style.top="-1em",popup.style.display="grid",popup.style.gridTemplateColumns="auto auto";const affirm=dom.createElement("div");affirm.style.gridColumn="1/2",affirm.style.gridRow="1";const cancel=dom.createElement("div");cancel.style.gridColumn="1/2",cancel.style.gridRow="2";const xButton=cancelButton(dom,removePopup);popup.appendChild(xButton),xButton.style.gridColumn="1",xButton.style.gridRow="2";const cancelPrompt=popup.appendChild(dom.createElement("button"));cancelPrompt.style=style.i.buttonStyle,cancelPrompt.style.gridRow="2",cancelPrompt.style.gridColumn="2",cancelPrompt.textContent="Cancel";const affirmIcon=buttons_button(dom,iconBase.Pt.iconBase+"noun_925021.svg","Delete it");popup.appendChild(affirmIcon),affirmIcon.style.gridRow="1",affirmIcon.style.gridColumn="1";const sureButtonElt=popup.appendChild(dom.createElement("button"));return sureButtonElt.style=style.i.buttonStyle,sureButtonElt.style.gridRow="1",sureButtonElt.style.gridColumn="2",sureButtonElt.textContent=prompt,popup.appendChild(sureButtonElt),affirmIcon.addEventListener("click",removePopupAndDoDeletion),sureButtonElt.addEventListener("click",removePopupAndDoDeletion),cancelPrompt.addEventListener("click",removePopup),popup}(dom,refererenceElement,prompt,deleteFunction))}),container.classList.add("hoverControl"),container.appendChild(deleteButton),deleteButton.setAttribute("data-testid","deleteButtonWithCheck"),deleteButton}function buttons_button(dom,iconURI,text,handler,options={buttonColor:"Primary",needsBorder:!1}){const button=dom.createElement("button");if(button.setAttribute("type","button"),iconURI){const img=button.appendChild(dom.createElement("img"));img.setAttribute("src",iconURI),img.setAttribute("style","width: 2em; height: 2em;"),img.title=text,button.setAttribute("style",style.i.buttonStyle)}else button.textContent=text.toLocaleUpperCase(),button.onmouseover=function(){"Secondary"===options.buttonColor?options.needsBorder?button.setAttribute("style",style.i.secondaryButtonNoBorderHover):button.setAttribute("style",style.i.secondaryButtonHover):options.needsBorder?button.setAttribute("style",style.i.primaryButtonNoBorderHover):button.setAttribute("style",style.i.primaryButtonHover)},button.onmouseout=function(){"Secondary"===options.buttonColor?options.needsBorder?button.setAttribute("style",style.i.secondaryButtonNoBorder):button.setAttribute("style",style.i.secondaryButton):options.needsBorder?button.setAttribute("style",style.i.primaryButtonNoBorder):button.setAttribute("style",style.i.primaryButton)},"Secondary"===options.buttonColor?options.needsBorder?button.setAttribute("style",style.i.secondaryButtonNoBorder):button.setAttribute("style",style.i.secondaryButton):options.needsBorder?button.setAttribute("style",style.i.primaryButtonNoBorder):button.setAttribute("style",style.i.primaryButton);return handler&&button.addEventListener("click",handler,!1),button}function cancelButton(dom,handler){const b=buttons_button(dom,cancelIconURI,"Cancel",handler);return b.firstChild&&(b.firstChild.style.opacity="0.3"),b}function continueButton(dom,handler){return buttons_button(dom,checkIconURI,"Continue",handler)}function askName(dom,kb,container,predicate,theClass,noun){return new Promise(function(resolve,_reject){const form=dom.createElement("div");predicate=predicate||ns.A.foaf("name");const prompt=(noun=noun||(theClass?label.P(theClass):"  "))+" "+label.P(predicate)+": ";form.appendChild(dom.createElement("p")).textContent=prompt;const namefield=dom.createElement("input");function gotName(){form.parentNode.removeChild(form),resolve(namefield.value.trim())}namefield.setAttribute("type","text"),namefield.setAttribute("size","100"),namefield.setAttribute("maxLength","2048"),namefield.setAttribute("style",style.i.textInputStyle),namefield.select(),form.appendChild(namefield),container.appendChild(form),namefield.addEventListener("keyup",function(e){13===e.keyCode&&gotName()},!1),form.appendChild(dom.createElement("br")),form.appendChild(cancelButton(dom,function(_event){form.parentNode.removeChild(form),resolve(null)})),form.appendChild(continueButton(dom,function(_event){gotName()})),namefield.focus()})}const personTR=function renderAsRow(dom,pred,obj,options){const tr=dom.createElement("tr");options=options||{};const td1=tr.appendChild(dom.createElement("td")),td2=tr.appendChild(dom.createElement("td")),td3=tr.appendChild(dom.createElement("td")),image=options.image||faviconOrDefault(dom,obj);td1.setAttribute("style","vertical-align: middle; width:2.5em; padding:0.5em; height: 2.5em;"),td2.setAttribute("style","vertical-align: middle; text-align:left;"),td3.setAttribute("style","vertical-align: middle; width:2em; padding:0.5em; height: 4em;"),td1.appendChild(image),options.title?td2.textContent=options.title:setName(td2,obj);options.deleteFunction&&deleteButtonWithCheck(dom,td3,options.noun||"one",options.deleteFunction);if(obj.uri){if(!1!==options.link){td3.appendChild((0,iconLinks.w)(dom,obj)).classList.add("HoverControlHide"),td3.appendChild(dom.createElement("br"))}!1!==options.draggable&&(image.setAttribute("draggable","false"),(0,dragAndDrop.eB)(tr,obj))}return tr.subject=obj,tr};function renderAsDiv(dom,obj,options){const div=dom.createElement("div");div.setAttribute("style",style.i.renderAsDivStyle);const image=(options=options||{}).image||faviconOrDefault(dom,obj);if(createImageDiv(dom,div,image),function createNameDiv(dom,div,title,obj){const nameDiv=div.appendChild(dom.createElement("div"));title?nameDiv.textContent=title:setName(nameDiv,obj)}(dom,div,options.title,obj),function createLinkDiv(dom,div,obj,options){const linkDiv=div.appendChild(dom.createElement("div"));linkDiv.setAttribute("style",style.i.linkDivStyle),options.deleteFunction&&deleteButtonWithCheck(dom,linkDiv,options.noun||"one",options.deleteFunction),obj.uri&&(!1!==options.link&&(0,iconLinks.O)(dom,linkDiv,obj),(0,dragAndDrop.eB)(div,obj))}(dom,div,obj,options),options.clickable&&options.onClickFunction&&addClickListenerToElement(div,options.onClickFunction),options.wrapInATR){return wrapDivInATR(dom,div,obj)}return div}function refreshTree(root){if(root.refresh)root.refresh();else for(let i=0;i<root.children.length;i++)refreshTree(root.children[i])}function attachmentList(dom,subject,div,options={}){function createNewRow(target){const theTarget=target,opt={noun};return modify&&(opt.deleteFunction=function(){!function(target){if(!kb.updater)throw new Error("kb has no updater");kb.updater.update((0,esm.st)(subject,predicate,target,doc),[],function(uri,ok,errorBody,_xhr){ok?refresh():complain(void 0,"Error deleting one: "+errorBody)})}(theTarget)}),personTR(dom,predicate,target,opt)}const refresh=function(){const things=kb.each(subject,predicate);things.sort(),utils.c5(attachmentTable,things,createNewRow)};function droppedURIHandler(uris){const ins=[];if(uris.forEach(function(u){const target=(0,esm.sym)(u);debug.Rm("Dropped on attachemnt "+u),ins.push((0,esm.st)(subject,predicate,target,doc))}),!kb.updater)throw new Error("kb has no updater");kb.updater.update([],ins,function(uri,ok,errorBody,_xhr){ok?refresh():complain(void 0,"Error adding one: "+errorBody)})}function droppedFileHandler(files){(0,dragAndDrop.Zn)(kb.fetcher,files,options.uploadFolder?.uri,options.uploadFolder?.uri,function(theFile,destURI){const ins=[(0,esm.st)(subject,predicate,kb.sym(destURI),doc)];if(!kb.updater)throw new Error("kb has no updater");kb.updater.update([],ins,function(uri,ok,errorBody,_xhr){ok?refresh():complain(void 0,"Error adding link to uploaded file: "+errorBody)})})}const doc=options.doc||subject.doc();void 0===options.modify&&(options.modify=!0);const modify=options.modify,promptIcon=options.promptIcon||buttons_iconBase+"noun_748003.svg",predicate=options.predicate||ns.A.wf("attachment"),noun=options.noun||"attachment",kb=solid_logic_esm.store,attachmentOuter=div.appendChild(dom.createElement("table"));attachmentOuter.setAttribute("style","margin-top: 1em; margin-bottom: 1em;");const attachmentOne=attachmentOuter.appendChild(dom.createElement("tr")),attachmentLeft=attachmentOne.appendChild(dom.createElement("td")),attachmentTable=attachmentOne.appendChild(dom.createElement("td")).appendChild(dom.createElement("table"));if(attachmentTable.appendChild(dom.createElement("tr")),attachmentOuter.refresh=refresh,refresh(),modify){const paperclip=buttons_button(dom,promptIcon,"Drop attachments here");attachmentLeft.appendChild(paperclip);const fhandler=options.uploadFolder?droppedFileHandler:null;if((0,dragAndDrop.DK)(paperclip,droppedURIHandler,fhandler),(0,dragAndDrop.DK)(attachmentLeft,droppedURIHandler,fhandler),options.uploadFolder){const buttonDiv=fileUploadButtonDiv(dom,droppedFileHandler);attachmentLeft.appendChild(buttonDiv)}}return attachmentOuter}function openHrefInOutlineMode(e){e.preventDefault(),e.stopPropagation();const uri=utils.EW(e).getAttribute("href");if(!uri)return debug.Rm("openHrefInOutlineMode: No href found!\n");const dom=window.document;dom.outlineManager?dom.outlineManager.GotoSubject(solid_logic_esm.store.sym(uri),!0,void 0,!0,void 0):window&&window.panes&&window.panes.getOutliner?window.panes.getOutliner().GotoSubject(solid_logic_esm.store.sym(uri),!0,void 0,!0,void 0):debug.Rm("ERROR: Can't access outline manager in this config")}function defaultAnnotationStore(subject){if(void 0===subject.uri)return;let s=subject.uri;if("http://"!==s.slice(0,7))return;s=s.slice(7);const hash=s.indexOf("#");if(hash>=0)s=s.slice(0,hash);else{const slash=s.lastIndexOf("/");if(slash<0)return;s=s.slice(0,slash)}return solid_logic_esm.store.sym("http://tabulator.org/wiki/annnotation/"+s)}function allClassURIs(){const set={};return solid_logic_esm.store.statementsMatching(void 0,ns.A.rdf("type"),void 0).forEach(function(st){st.object.value&&(set[st.object.value]=!0)}),solid_logic_esm.store.statementsMatching(void 0,ns.A.rdfs("subClassOf"),void 0).forEach(function(st){st.object.value&&(set[st.object.value]=!0),st.subject.value&&(set[st.subject.value]=!0)}),solid_logic_esm.store.each(void 0,ns.A.rdf("type"),ns.A.rdfs("Class")).forEach(function(c){c.value&&(set[c.value]=!0)}),set}function propertyTriage(kb){const possibleProperties={},dp={},op={};let no=0,nd=0,nu=0;const pi=kb.predicateIndex;for(const p in pi){"Literal"===pi[p][0].object.termType?(dp[p]=!0,nd++):(op[p]=!0,no++)}const ps=kb.each(void 0,ns.A.rdf("type"),ns.A.rdf("Property"));for(let i=0;i<ps.length;i++){const p=ps[i].toNT();op[p]||dp[p]||(dp[p]=!0,op[p]=!0,nu++)}return possibleProperties.op=op,possibleProperties.dp=dp,(0,log.info)(`propertyTriage: ${no} non-lit, ${nd} literal. ${nu} unknown.`),possibleProperties}function linkButton(dom,object){const b=dom.createElement("button");return b.setAttribute("type","button"),b.textContent="Goto "+label.P(object),b.addEventListener("click",function(_event){dom.outlineManager.GotoSubject(object,!0,void 0,!0,void 0)},!0),b}function removeButton(dom,element){const b=dom.createElement("button");return b.setAttribute("type","button"),b.textContent="âœ•",b.addEventListener("click",function(_event){element.parentNode.removeChild(element)},!0),b}function selectorPanel(dom,kb,type,predicate,inverse,possible,options,callbackFunction,linkCallback){return selectorPanelRefresh(dom.createElement("div"),dom,kb,type,predicate,inverse,possible,options,callbackFunction,linkCallback)}function selectorPanelRefresh(list,dom,kb,type,predicate,inverse,possible,options,callbackFunction,linkCallback){const style0="border: 0.1em solid #ddd; border-bottom: none; width: 95%; height: 2em; padding: 0.5em;";let selected=null;list.innerHTML="";const refreshItem=function(box,x){let item,image;const setStyle=function(){const already=inverse?kb.each(void 0,predicate,x):kb.each(x,predicate);iconDiv.setAttribute("class",0===already.length?"hideTillHover":""),image.setAttribute("src",options.connectIcon||buttons_iconBase+"noun_25830.svg"),image.setAttribute("title",already.length?already.length:"attach")},f=index.twoLine.widgetForClass(type);item=f(dom,x),item.setAttribute("style",style0);const nav=dom.createElement("div");nav.setAttribute("class","hideTillHover"),nav.setAttribute("style","float:right; width:10%");const a=dom.createElement("a");a.setAttribute("href",x.uri),a.setAttribute("style","float:right"),nav.appendChild(a).textContent=">",box.appendChild(nav);const iconDiv=dom.createElement("div");return iconDiv.setAttribute("style",(inverse?"float:left;":"float:right;")+" width:30px;"),image=dom.createElement("img"),setStyle(),iconDiv.appendChild(image),box.appendChild(iconDiv),item.addEventListener("click",function(event){selected===item?(item.setAttribute("style",style0),selected=null):(selected&&selected.setAttribute("style",style0),item.setAttribute("style",style0+"background-color: #ccc; color:black;"),selected=item),callbackFunction(x,event,selected===item),setStyle()},!1),image.addEventListener("click",function(event){linkCallback(x,event,inverse,setStyle)},!1),box.appendChild(item),box};for(let i=0;i<possible.length;i++){const box=dom.createElement("div");list.appendChild(box),refreshItem(box,possible[i])}return list}let index={};function addStyleSheet(dom,href){const links=dom.querySelectorAll("link");for(let i=0;i<links.length;i++)if("stylesheet"===(links[i].getAttribute("rel")||"")&&(links[i].getAttribute("href")||"")===href)return;const link=dom.createElement("link");link.setAttribute("rel","stylesheet"),link.setAttribute("type","text/css"),link.setAttribute("href",href),dom.getElementsByTagName("head")[0].appendChild(link)}function isAudio(file){return isImage(file,"audio")}function isVideo(file){return isImage(file,"video")}function isImage(file,kind){const what=kind||"image",typeURIs=solid_logic_esm.store.findTypeURIs(file),prefix=utils_js.mediaTypeClass(what+"/*").uri.split("*")[0];for(const t in typeURIs)if(t.startsWith(prefix))return!0;return{audio:"http://purl.org/dc/dcmitype/Sound",image:"http://purl.org/dc/dcmitype/Image",video:"http://purl.org/dc/dcmitype/MovingImage"}[what]in typeURIs}function fileUploadButtonDiv(dom,droppedFileHandler){const div=dom.createElement("div"),input=div.appendChild(dom.createElement("input"));input.setAttribute("type","file"),input.setAttribute("multiple","true"),input.addEventListener("change",event=>{debug.Rm("File drop event: ",event),event.files?droppedFileHandler(event.files):event.target&&event.target.files?droppedFileHandler(event.target.files):alert("Sorry no files .. internal error?")},!1),input.style="display:none";const buttonElt=div.appendChild(buttons_button(dom,buttons_iconBase+"noun_Upload_76574_000000.svg","Upload files",_event=>{input.click()}));return(0,dragAndDrop.DK)(buttonElt,null,droppedFileHandler),div}index={line:{},twoLine:{"":function twoLineDefault(dom,x){const box=dom.createElement("div");return box.textContent=label.P(x),box},"http://www.w3.org/2000/10/swap/pim/qif#Transaction":function twoLineTransaction(dom,x){let failed="";const enc=function(p){const y=solid_logic_esm.store.any(x,ns.A.qu(p));return y||(failed+="@@ No value for "+p+"! "),y?utils.AW(y.value):"?"},box=dom.createElement("table");return box.innerHTML=`\n      <tr>\n      <td colspan="2"> ${enc("payee")}</td>\n      < /tr>\n      < tr >\n      <td>${enc("date").slice(0,10)}</td>\n      <td style = "text-align: right;">${enc("amount")}</td>\n      </tr>`,failed&&(box.innerHTML=`\n      <tr>\n        <td><a href="${utils.AW(x.uri)}">${utils.AW(failed)}</a></td>\n      </tr>`),box},"http://www.w3.org/ns/pim/trip#Trip":function twoLineTrip(dom,x){const enc=function(p){const y=solid_logic_esm.store.any(x,p);return y?utils.AW(y.value):"?"},box=dom.createElement("table");return box.innerHTML=`\n    <tr>\n      <td colspan="2">${enc(ns.A.dc("title"))}</td>\n    </tr>\n    <tr style="color: #777">\n      <td>${enc(ns.A.cal("dtstart"))}</td>\n      <td>${enc(ns.A.cal("dtend"))}</td>\n    </tr>`,box},widgetForClass:function twoLineWidgetForClass(c){let widget=index.twoLine[c.uri];const kb=solid_logic_esm.store;if(widget)return widget;const sup=kb.findSuperClassesNT(c);for(const cl in sup)if(widget=index.twoLine[kb.fromNT(cl).uri],widget)return widget;return index.twoLine[""]}}}},"./src/widgets/buttons/iconLinks.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>createLinkForURI,w:()=>linkIcon});var _iconBase__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/iconBase.ts");function linkIcon(dom,subject,iconURI){const anchor=dom.createElement("a");anchor.setAttribute("href",subject.uri),subject.uri.startsWith("http")&&anchor.setAttribute("target","_blank");const img=anchor.appendChild(dom.createElement("img"));return img.setAttribute("src",iconURI||_iconBase__WEBPACK_IMPORTED_MODULE_0__.i1+"go-to-this.png"),img.setAttribute("style","margin: 0.3em;"),anchor}const createLinkForURI=(dom,linkDiv,obj)=>{const iconLink=linkIcon(dom,obj);linkDiv.appendChild(iconLink).classList.add("HoverControlHide"),linkDiv.appendChild(dom.createElement("br"))}},"./src/widgets/error.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>errorMessageBlock});var _widgets__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/widgets/buttons.ts"),_style__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/style.js"),_styleConstants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/styleConstants.js");function errorMessageBlock(dom,err,backgroundColor,err2){const div=dom.createElement("div"),errorObject=err2||err instanceof Error?err:null;return errorObject?(console.error(`errorMessageBlock: ${errorObject} at: ${errorObject.stack||"??"}`,errorObject),div.textContent=errorObject.message):div.textContent=err,div.appendChild((0,_widgets__WEBPACK_IMPORTED_MODULE_0__.x7)(dom,()=>{div.parentNode&&div.parentNode.removeChild(div)})).style=_style__WEBPACK_IMPORTED_MODULE_1__.i.errorCancelButton,div.setAttribute("style",_style__WEBPACK_IMPORTED_MODULE_1__.i.errorMessageBlockStyle),div.style.backgroundColor=backgroundColor||_styleConstants__WEBPACK_IMPORTED_MODULE_2__.A.defaultErrorBackgroundColor,div}}}]);